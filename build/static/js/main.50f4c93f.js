/*! For license information please see main.50f4c93f.js.LICENSE.txt */
(()=>{"use strict";var t={153(t,e,n){var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,n){var r,s={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(u=e.ref),e)o.call(e,r)&&!c.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===s[r]&&(s[r]=e[r]);return{$$typeof:i,type:t,key:l,ref:u,props:s,_owner:a.current}}},202(t,e){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function v(){}function w(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var _=w.prototype=new v;_.constructor=w,g(_,y.prototype),_.isPureReactComponent=!0;var E=Array.isArray,I=Object.prototype.hasOwnProperty,b={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,r){var i,s={},o=null,a=null;if(null!=e)for(i in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(o=""+e.key),e)I.call(e,i)&&!T.hasOwnProperty(i)&&(s[i]=e[i]);var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(i in c=t.defaultProps)void 0===s[i]&&(s[i]=c[i]);return{$$typeof:n,type:t,key:o,ref:a,props:s,_owner:b.current}}function A(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function k(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(t){return e[t]})}(""+t.key):e.toString(36)}function R(t,e,i,s,o){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var c=!1;if(null===t)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=t),t=""===s?"."+k(c,0):s,E(o)?(i="",null!=t&&(i=t.replace(C,"$&/")+"/"),R(o,e,i,"",function(t){return t})):null!=o&&(A(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,i+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+t)),e.push(o)),1;if(c=0,s=""===s?".":s+":",E(t))for(var l=0;l<t.length;l++){var u=s+k(a=t[l],l);c+=R(a,e,i,u,o)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),l=0;!(a=t.next()).done;)c+=R(a=a.value,e,i,u=s+k(a,l++),o);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function N(t,e,n){if(null==t)return t;var r=[],i=0;return R(t,r,"","",function(t){return e.call(n,t,i++)}),r}function O(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var P={current:null},D={transition:null},L={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:b};function M(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:N,forEach:function(t,e,n){N(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return N(t,function(){e++}),e},toArray:function(t){return N(t,function(t){return t})||[]},only:function(t){if(!A(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=i,e.Profiler=o,e.PureComponent=w,e.StrictMode=s,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,e.act=M,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=g({},t.props),s=t.key,o=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,a=b.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)I.call(e,l)&&!T.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}return{$$typeof:n,type:t.type,key:s,ref:o,props:i,_owner:a}},e.createContext=function(t){return(t={$$typeof:c,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=A,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:O}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=D.transition;D.transition={};try{t()}finally{D.transition=e}},e.unstable_act=M,e.useCallback=function(t,e){return P.current.useCallback(t,e)},e.useContext=function(t){return P.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return P.current.useDeferredValue(t)},e.useEffect=function(t,e){return P.current.useEffect(t,e)},e.useId=function(){return P.current.useId()},e.useImperativeHandle=function(t,e,n){return P.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return P.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return P.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return P.current.useMemo(t,e)},e.useReducer=function(t,e,n){return P.current.useReducer(t,e,n)},e.useRef=function(t){return P.current.useRef(t)},e.useState=function(t){return P.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return P.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return P.current.useTransition()},e.version="18.3.1"},43(t,e,n){t.exports=n(202)},579(t,e,n){n(153)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,n),s.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}();n(43);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}function s(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}const c=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const e=t[i],s=i+1<t.length,o=s?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,l=e>>2,u=(3&e)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const e=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0;++i;const o=i<t.length?n[t.charAt(i)]:64;++i;const a=i<t.length?n[t.charAt(i)]:64;if(++i,null==e||null==s||null==o||null==a)throw new u;const c=e<<2|s>>4;if(r.push(c),64!==o){const t=s<<4&240|o>>2;if(r.push(t),64!==a){const t=o<<6&192|a;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class u extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const h=function(t){return function(t){const e=c(t);return l.encodeByteArray(e,!0)}(t).replace(/\./g,"")},d=function(t){try{return l.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const p=()=>{try{return f().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const e=t&&d(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},g=t=>{var e;return null===(e=p())||void 0===e||null===(e=e.emulatorHosts)||void 0===e?void 0:e[t]},m=()=>{var t;return null===(t=p())||void 0===t?void 0:t.config},y=t=>{var e;return null===(e=p())||void 0===e?void 0:e["_".concat(t)]};class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function w(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch(e){return!1}}async function _(t){return(await fetch(t,{credentials:"include"})).ok}const E={};let I=!1;function b(t,e){if("undefined"===typeof window||"undefined"===typeof document||!w(window.location.host)||E[t]===e||E[t]||I)return;function n(t){return"__firebase__banner__".concat(t)}E[t]=e;const r="__firebase__banner",i=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(E))E[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function s(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{I=!0,function(){const t=document.getElementById(r);t&&t.remove()}()},t}function o(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(r),e=n("text"),o=document.getElementById(e)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(c,a);const n=s();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,l),e.append(u,o,c,n),document.body.appendChild(e)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function T(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function S(){var t;const e=null===(t=p())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function A(){return!S()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){try{return"object"===typeof indexedDB}catch(t){return!1}}class k extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),r=this.errors[t],i=r?function(t,e){return t.replace(N,(t,n)=>{const r=e[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,e):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new k(n,s,e)}}const N=/\{\$([^}]+)}/g;function O(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(P(n)&&P(s)){if(!O(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function P(t){return null!==t&&"object"===typeof t}function D(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function L(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[n,r]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(r)}}),e}function M(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class x{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let r;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!==typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"===typeof t[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=V),void 0===r.error&&(r.error=V),void 0===r.complete&&(r.complete=V);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(t){}}),this.observers.push(r),i}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function V(){}function U(t){return t&&t._delegate?t._delegate:t}class F{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const j="[DEFAULT]";class B{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new v;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:j})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:r});n.resolve(t)}catch(e){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(r){}}getOrInitializeService(t){let{instanceIdentifier:e,options:n={}}=t,r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===j?void 0:i),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.component?this.component.multipleInstances?t:j:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class H{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new B(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const q=[];var W;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(W||(W={}));const z={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},K=W.INFO,G={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},J=function(t,e){if(e<t.logLevel)return;const n=(new Date).toISOString(),r=G[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(t.name,":"),...s)};class X{constructor(t){this.name=t,this._logLevel=K,this._logHandler=J,this._userLogHandler=null,q.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in W))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?z[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}}let Q,Y;const $=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,nt=new WeakMap;let rt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Z.get(t);if("objectStoreNames"===e)return t.objectStoreNames||tt.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ot(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function it(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Y||(Y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(at(this),n),ot($.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ot(t.apply(at(this),n))}:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=t.call(at(this),e,...r);return tt.set(s,e.sort?e.sort():[e]),ot(s)}}function st(t){return"function"===typeof t?it(t):(t instanceof IDBTransaction&&function(t){if(Z.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)});Z.set(t,e)}(t),e=t,(Q||(Q=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(t,rt):t);var e}function ot(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(ot(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)});return e.then(e=>{e instanceof IDBCursor&&$.set(e,t)}).catch(()=>{}),nt.set(e,t),e}(t);if(et.has(t))return et.get(t);const e=st(t);return e!==t&&(et.set(t,e),nt.set(e,t)),e}const at=t=>nt.get(t);const ct=["get","getKey","getAll","getAllKeys","count"],lt=["put","add","delete","clear"],ut=new Map;function ht(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(ut.get(e))return ut.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=lt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!ct.includes(n))return;const s=async function(t){const e=this.transaction(t,i?"readwrite":"readonly");let s=e.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&e.done]))[0]};return ut.set(e,s),s}rt=(t=>a(a({},t),{},{get:(e,n,r)=>ht(e,n)||t.get(e,n,r),has:(e,n)=>!!ht(e,n)||t.has(e,n)}))(rt);class dt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null}).filter(t=>t).join(" ")}}const ft="@firebase/app",pt="0.14.8",gt=new X("@firebase/app"),mt="@firebase/app-compat",yt="@firebase/analytics-compat",vt="@firebase/analytics",wt="@firebase/app-check-compat",_t="@firebase/app-check",Et="@firebase/auth",It="@firebase/auth-compat",bt="@firebase/database",Tt="@firebase/data-connect",St="@firebase/database-compat",At="@firebase/functions",Ct="@firebase/functions-compat",kt="@firebase/installations",Rt="@firebase/installations-compat",Nt="@firebase/messaging",Ot="@firebase/messaging-compat",Pt="@firebase/performance",Dt="@firebase/performance-compat",Lt="@firebase/remote-config",Mt="@firebase/remote-config-compat",xt="@firebase/storage",Vt="@firebase/storage-compat",Ut="@firebase/firestore",Ft="@firebase/ai",jt="@firebase/firestore-compat",Bt="firebase",Ht="[DEFAULT]",qt={[ft]:"fire-core",[mt]:"fire-core-compat",[vt]:"fire-analytics",[yt]:"fire-analytics-compat",[_t]:"fire-app-check",[wt]:"fire-app-check-compat",[Et]:"fire-auth",[It]:"fire-auth-compat",[bt]:"fire-rtdb",[Tt]:"fire-data-connect",[St]:"fire-rtdb-compat",[At]:"fire-fn",[Ct]:"fire-fn-compat",[kt]:"fire-iid",[Rt]:"fire-iid-compat",[Nt]:"fire-fcm",[Ot]:"fire-fcm-compat",[Pt]:"fire-perf",[Dt]:"fire-perf-compat",[Lt]:"fire-rc",[Mt]:"fire-rc-compat",[xt]:"fire-gcs",[Vt]:"fire-gcs-compat",[Ut]:"fire-fst",[jt]:"fire-fst-compat",[Ft]:"fire-vertex","fire-js":"fire-js",[Bt]:"fire-js-all"},Wt=new Map,zt=new Map,Kt=new Map;function Gt(t,e){try{t.container.addComponent(e)}catch(n){gt.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function Jt(t){const e=t.name;if(Kt.has(e))return gt.debug("There were multiple attempts to register component ".concat(e,".")),!1;Kt.set(e,t);for(const n of Wt.values())Gt(n,t);for(const n of zt.values())Gt(n,t);return!0}function Xt(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qt(t){return null!==t&&void 0!==t&&void 0!==t.settings}const Yt=new R("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class $t{constructor(t,e,n){this._isDeleted=!1,this._options=a({},t),this._config=a({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new F("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Yt.create("app-deleted",{appName:this._name})}}const Zt="12.9.0";function te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if("object"!==typeof e){e={name:e}}const r=a({name:Ht,automaticDataCollectionEnabled:!0},e),i=r.name;if("string"!==typeof i||!i)throw Yt.create("bad-app-name",{appName:String(i)});if(n||(n=m()),!n)throw Yt.create("no-options");const s=Wt.get(i);if(s){if(O(n,s.options)&&O(r,s.config))return s;throw Yt.create("duplicate-app",{appName:i})}const o=new H(i);for(const a of Kt.values())o.addComponent(a);const c=new $t(n,r,o);return Wt.set(i,c),c}function ee(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht;const e=Wt.get(t);if(!e&&t===Ht&&m())return te();if(!e)throw Yt.create("no-app",{appName:t});return e}function ne(t,e,n){var r;let i=null!==(r=qt[t])&&void 0!==r?r:t;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=['Unable to register library "'.concat(i,'" with version "').concat(e,'":')];return s&&t.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&t.push("and"),o&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void gt.warn(t.join(" "))}Jt(new F("".concat(i,"-version"),()=>({library:i,version:e}),"VERSION"))}const re="firebase-heartbeat-store";let ie=null;function se(){return ie||(ie=function(t,e){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(t,e),a=ot(o);return r&&o.addEventListener("upgradeneeded",t=>{r(ot(o.result),t.oldVersion,t.newVersion,ot(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),a.then(t=>{s&&t.addEventListener("close",()=>s()),i&&t.addEventListener("versionchange",t=>i(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(re)}catch(n){console.warn(n)}}}).catch(t=>{throw Yt.create("idb-open",{originalErrorMessage:t.message})})),ie}async function oe(t,e){try{const n=(await se()).transaction(re,"readwrite"),r=n.objectStore(re);await r.put(e,ae(t)),await n.done}catch(n){if(n instanceof k)gt.warn(n.message);else{const t=Yt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});gt.warn(t.message)}}}function ae(t){return"".concat(t.name,"!").concat(t.options.appId)}class ce{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new ue(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){try{var t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=le();var e;if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(t=>t.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){gt.warn(n)}}async getHeartbeatsHeader(){try{var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=le(),{heartbeatsToSend:n,unsentEntries:r}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=t.slice();for(const i of t){const t=n.find(t=>t.agent===i.agent);if(t){if(t.dates.push(i.date),he(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),he(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=h(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return gt.warn(e),""}}}function le(){return(new Date).toISOString().substring(0,10)}class ue{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!C()&&new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await se()).transaction(re),n=await e.objectStore(re).get(ae(t));return await e.done,n}catch(e){if(e instanceof k)gt.warn(e.message);else{const t=Yt.create("idb-get",{originalErrorMessage:null===e||void 0===e?void 0:e.message});gt.warn(t.message)}}}(this.app);return null!==t&&void 0!==t&&t.heartbeats?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){var e;const n=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){if(await this._canUseIndexedDBPromise){var e;const n=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function he(t){return h(JSON.stringify({version:2,heartbeats:t})).length}var de;de="",Jt(new F("platform-logger",t=>new dt(t),"PRIVATE")),Jt(new F("heartbeat",t=>new ce(t),"PRIVATE")),ne(ft,pt,de),ne(ft,pt,"esm2020"),ne("fire-js","");function fe(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}ne("firebase","12.9.0","app");const pe=["providerId"],ge=["uid","auth","stsTokenManager"],me=["providerId","signInMethod"];function ye(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ve=ye,we=new R("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),_e=new X("@firebase/auth");function Ee(t){if(_e.logLevel<=W.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];_e.error("Auth (".concat(Zt,"): ").concat(t),...n)}}function Ie(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Ae(t,...n)}function be(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Ae(t,...n)}function Te(t,e,n){const r=a(a({},ve()),{},{[e]:n});return new R("auth","Firebase",r).create(e,{appName:t.name})}function Se(t){return Te(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ae(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("string"!==typeof t){const e=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(e,...r)}return we.create(t,...n)}function Ce(t,e){if(!t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Ae(e,...r)}}function ke(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ee(e),new Error(e)}function Re(t,e){t||ke(e)}function Ne(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Oe(){return"http:"===Pe()||"https:"===Pe()}function Pe(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function De(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Oe()||function(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Le{constructor(t,e){this.shortDelay=t,this.longDelay=e,Re(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(T())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return De()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Me(t,e){Re(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?"".concat(n).concat(e.startsWith("/")?e.slice(1):e):n}class xe{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void ke("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void ke("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void ke("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ve={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ue=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fe=new Le(3e4,6e4);function je(t,e){return t.tenantId&&!e.tenantId?a(a({},e),{},{tenantId:t.tenantId}):e}async function Be(t,e,n,r){return He(t,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===e?s=r:i={body:JSON.stringify(r)});const o=D(a({key:t.config.apiKey},s)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l=a({method:e,headers:c},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&w(t.emulatorConfig.host)&&(l.credentials="include"),xe.fetch()(await We(t,t.config.apiHost,n,o),l)})}async function He(t,e,n){t._canInitEmulator=!1;const r=a(a({},Ve),e);try{const e=new Ke(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Ge(t,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const e=i.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ge(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Ge(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw Ge(t,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Te(t,a,o);Ie(t,a)}}catch(i){if(i instanceof k)throw i;Ie(t,"network-request-failed",{message:String(i)})}}async function qe(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Be(t,e,n,r,i);return"mfaPendingCredential"in s&&Ie(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function We(t,e,n,r){const i="".concat(e).concat(n,"?").concat(r),s=t,o=s.config.emulator?Me(t.config,i):"".concat(t.config.apiScheme,"://").concat(i);if(Ue.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function ze(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ke{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((t,e)=>{this.timer=setTimeout(()=>e(be(this.auth,"network-request-failed")),Fe.get())})}}function Ge(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=be(t,e,r);return i.customData._tokenResponse=n,i}function Je(t){return void 0!==t&&void 0!==t.enterprise}class Xe{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return ze(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Qe(t,e){return Be(t,"GET","/v2/recaptchaConfig",je(t,e))}async function Ye(t,e){return Be(t,"POST","/v1/accounts:lookup",e)}function $e(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function Ze(t){return 1e3*Number(t)}function tn(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return Ee("JWT malformed, contained fewer than 3 sections"),null;try{const t=d(n);return t?JSON.parse(t):(Ee("Failed to decode base64 JWT payload"),null)}catch(i){return Ee("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function en(t){const e=tn(t);return Ce(e,"internal-error"),Ce("undefined"!==typeof e.exp,"internal-error"),Ce("undefined"!==typeof e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function nn(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e;try{return await e}catch(n){throw n instanceof k&&function(t){let{code:e}=t;return e==="auth/".concat("user-disabled")||e==="auth/".concat("user-token-expired")}(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}class rn{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{var e;this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void((null===t||void 0===t?void 0:t.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class sn{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=$e(this.lastLoginAt),this.creationTime=$e(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function on(t){var e;const n=t.auth,r=await t.getIdToken(),i=await nn(t,Ye(n,{idToken:r}));Ce(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?an(s.providerUserInfo):[],a=(c=t.providerData,l=o,[...c.filter(t=>!l.some(e=>e.providerId===t.providerId)),...l]);var c,l;const u=t.isAnonymous,h=!(t.email&&s.passwordHash)&&!(null!==a&&void 0!==a&&a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new sn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}function an(t){return t.map(t=>{let{providerId:e}=t,n=fe(t,pe);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class cn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ce(t.idToken,"internal-error"),Ce("undefined"!==typeof t.idToken,"internal-error"),Ce("undefined"!==typeof t.refreshToken,"internal-error");const e="expiresIn"in t&&"undefined"!==typeof t.expiresIn?Number(t.expiresIn):en(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Ce(0!==t.length,"internal-error");const e=en(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Ce(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(t,e){const n=await He(t,{},async()=>{const n=D({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,s=await We(t,r,"/v1/token","key=".concat(i)),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return t.emulatorConfig&&w(t.emulatorConfig.host)&&(a.credentials="include"),xe.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:r,expirationTime:i}=e,s=new cn;return n&&(Ce("string"===typeof n,"internal-error",{appName:t}),s.refreshToken=n),r&&(Ce("string"===typeof r,"internal-error",{appName:t}),s.accessToken=r),i&&(Ce("number"===typeof i,"internal-error",{appName:t}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new cn,this.toJSON())}_performRefresh(){return ke("not implemented")}}function ln(t,e){Ce("string"===typeof t||"undefined"===typeof t,"internal-error",{appName:e})}class un{constructor(t){let{uid:e,auth:n,stsTokenManager:r}=t,i=fe(t,ge);this.providerId="firebase",this.proactiveRefresh=new rn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new sn(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await nn(this,this.stsTokenManager.getToken(this.auth,t));return Ce(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=U(t),r=await n.getIdToken(e),i=tn(r);Ce(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:$e(Ze(i.auth_time)),issuedAtTime:$e(Ze(i.iat)),expirationTime:$e(Ze(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=U(t);await on(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Ce(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(t=>a({},t)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new un(a(a({},this),{},{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await on(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qt(this.auth.app))return Promise.reject(Se(this.auth));const t=await this.getIdToken();return await nn(this,async function(t,e){return Be(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return a(a({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>a({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,r,i,s,o,c,l,u;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,d=null!==(r=e.email)&&void 0!==r?r:void 0,f=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=e.photoURL)&&void 0!==s?s:void 0,g=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(c=e._redirectEventId)&&void 0!==c?c:void 0,y=null!==(l=e.createdAt)&&void 0!==l?l:void 0,v=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:w,emailVerified:_,isAnonymous:E,providerData:I,stsTokenManager:b}=e;Ce(w&&b,t,"internal-error");const T=cn.fromJSON(this.name,b);Ce("string"===typeof w,t,"internal-error"),ln(h,t.name),ln(d,t.name),Ce("boolean"===typeof _,t,"internal-error"),Ce("boolean"===typeof E,t,"internal-error"),ln(f,t.name),ln(p,t.name),ln(g,t.name),ln(m,t.name),ln(y,t.name),ln(v,t.name);const S=new un({uid:w,auth:t,email:d,emailVerified:_,displayName:h,isAnonymous:E,photoURL:p,phoneNumber:f,tenantId:g,stsTokenManager:T,createdAt:y,lastLoginAt:v});return I&&Array.isArray(I)&&(S.providerData=I.map(t=>a({},t))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new cn;r.updateFromServerResponse(e);const i=new un({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:n});return await on(i),i}static async _fromGetAccountInfoResponse(t,e,n){const r=e.users[0];Ce(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?an(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length),o=new cn;o.updateFromIdToken(n);const a=new un({uid:r.localId,auth:t,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new sn(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length)};return Object.assign(a,c),a}}const hn=new Map;function dn(t){Re(t instanceof Function,"Expected a class definition");let e=hn.get(t);return e?(Re(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hn.set(t,e),e)}class fn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}fn.type="NONE";const pn=fn;function gn(t,e,n){return"firebase".concat(":",t,":").concat(e,":").concat(n)}class mn{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=gn(this.userKey,r.apiKey,i),this.fullPersistenceKey=gn("persistence",r.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if("string"===typeof t){const e=await Ye(this.auth,{idToken:t}).catch(()=>{});return e?un._fromGetAccountInfoResponse(this.auth,e,t):null}return un._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!e.length)return new mn(dn(pn),t,n);const r=(await Promise.all(e.map(async t=>{if(await t._isAvailable())return t}))).filter(t=>t);let i=r[0]||dn(pn);const s=gn(n,t.config.apiKey,t.name);let o=null;for(const l of e)try{const e=await l._get(s);if(e){let n;if("string"===typeof e){const r=await Ye(t,{idToken:e}).catch(()=>{});if(!r)break;n=await un._fromGetAccountInfoResponse(t,r,e)}else n=un._fromJSON(t,e);l!==i&&(o=n),i=l;break}}catch(c){}const a=r.filter(t=>t._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(e.map(async t=>{if(t!==i)try{await t._remove(s)}catch(e){}})),new mn(i,t,n)):new mn(i,t,n)}}function yn(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(En(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vn(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bn(e))return"Blackberry";if(Tn(e))return"Webos";if(wn(e))return"Safari";if((e.includes("chrome/")||_n(e))&&!e.includes("edge/"))return"Chrome";if(In(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function vn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/firefox\//i.test(t)}function wn(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T()).toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function _n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/crios\//i.test(t)}function En(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iemobile/i.test(t)}function In(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/android/i.test(t)}function bn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/blackberry/i.test(t)}function Tn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/webos/i.test(t)}function Sn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function An(){return function(){const t=T();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}function Cn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return Sn(t)||In(t)||Tn(t)||bn(t)||/windows phone/i.test(t)||En(t)}function kn(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(t){case"Browser":e=yn(T());break;case"Worker":e="".concat(yn(T()),"-").concat(t);break;default:e=t}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(e,"/","JsCore","/").concat(Zt,"/").concat(r)}class Rn{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise((n,r)=>{try{n(t(e))}catch(i){r(i)}});n.onAbort=e,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const t of e)try{t()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Nn{constructor(t){var e,n,r,i;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=t.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(i=t.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),r&&(e.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let r=0;r<t.length;r++)n=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=i))}}class On{constructor(t,e,n,r){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dn(this),this.idTokenSubscription=new Dn(this),this.beforeStateQueue=new Rn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=we,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(t=>this._resolvePersistenceManagerAvailable=t)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=dn(e)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await mn.create(this,t),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await Ye(this,{idToken:t}),n=await un._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(Qt(this.app)){const t=this.app.settings.authIdToken;return t?new Promise(e=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(t).then(e,e))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let n=e,r=!1;if(t&&this.config.authDomain){var i,s;await this.getOrInitRedirectPersistenceManager();const e=null===(i=this.redirectUser)||void 0===i?void 0:i._redirectEventId,o=null===(s=n)||void 0===s?void 0:s._redirectEventId,a=await this.tryRedirectSignIn(t);e&&e!==o||null===a||void 0===a||!a.user||(n=a.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(n){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await on(t)}catch(e){if((null===e||void 0===e?void 0:e.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Qt(this.app))return Promise.reject(Se(this));const e=t?U(t):null;return e&&Ce(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return t&&Ce(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Qt(this.app)?Promise.reject(Se(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Qt(this.app)?Promise.reject(Se(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(dn(t))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t){return Be(t,"GET","/v2/passwordPolicy",je(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),e=new Nn(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new R("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Be(t,"POST","/v2/accounts:revokeToken",je(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&dn(t)||this._popupRedirectResolver;Ce(e,this,"argument-error"),this.redirectPersistenceManager=await mn.create(this,[dn(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,r){if(this._deleted)return()=>{};const i="function"===typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"===typeof e){const i=t.addObserver(e,n,r);return()=>{s=!0,i()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=kn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Qt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return null!==e&&void 0!==e&&e.error&&function(t){if(_e.logLevel<=W.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];_e.warn("Auth (".concat(Zt,"): ").concat(t),...n)}}("Error while retrieving App Check token: ".concat(e.error)),null===e||void 0===e?void 0:e.token}}function Pn(t){return U(t)}class Dn{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new x(t,e);return n.subscribe.bind(n)}(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ln={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Mn(t){return Ln.loadJS(t)}function xn(t){return"__".concat(t).concat(Math.floor(1e6*Math.random()))}class Vn{constructor(){this.enterprise=new Un}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class Un{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const Fn="NO_RECAPTCHA";class jn{constructor(t){this.type="recaptcha-enterprise",this.auth=Pn(t)}async verify(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(e,n,r){const i=window.grecaptcha;Je(i)?i.enterprise.ready(()=>{i.enterprise.execute(e,{action:t}).then(t=>{n(t)}).catch(()=>{n(Fn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Vn).execute("siteKey",{action:"verify"})}return new Promise((t,r)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise(async(e,n)=>{Qe(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Xe(r);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(t=>{n(t)})})})(this.auth).then(i=>{if(!e&&Je(window.grecaptcha))n(i,t,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let e=Ln.recaptchaEnterpriseScript;0!==e.length&&(e+=i),Mn(e).then(()=>{n(i,t,r)}).catch(t=>{r(t)})}}).catch(t=>{r(t)})})}}async function Bn(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new jn(t);let o;if(i)o=Fn;else try{o=await s.verify(n)}catch(l){o=await s.verify(n,!0)}const c=a({},e);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in c){const t=c.phoneEnrollmentInfo.phoneNumber,e=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const t=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Hn(t,e,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){var s;if(null!==(s=t._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Bn(t,e,n,"getOobCode"===n);return r(t,i)}return r(t,e).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Bn(t,e,n,"getOobCode"===n);return r(t,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){var o;if(null!==(o=t._getRecaptchaConfig())&&void 0!==o&&o.isProviderEnabled("PHONE_PROVIDER")){const i=await Bn(t,e,n);return r(t,i).catch(async i=>{var s;if("AUDIT"===(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&(i.code==="auth/".concat("missing-recaptcha-token")||i.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const i=await Bn(t,e,n,!1,!0);return r(t,i)}return Promise.reject(i)})}{const i=await Bn(t,e,n,!1,!0);return r(t,i)}}return Promise.reject(i+" provider is not supported.")}async function qn(t){const e=Pn(t),n=await Qe(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Xe(n);if(null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()){new jn(e).verify()}}function Wn(t,e,n){const r=Pn(t);Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!(null===n||void 0===n||!n.disableWarnings),s=zn(e),{host:o,port:a}=function(t){const e=zn(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const t=i[1];return{host:t,port:Kn(r.substr(t.length+1))}}{const[t,e]=r.split(":");return{host:t,port:Kn(e)}}}(e),c=null===a?"":":".concat(a),l={url:"".concat(s,"//").concat(o).concat(c,"/")},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return Ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Ce(O(l,r.config.emulator)&&O(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,w(o)?(_("".concat(s,"//").concat(o).concat(c)),b("Auth",!0)):i||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function zn(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Kn(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Gn{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return ke("not implemented")}_getIdTokenResponse(t){return ke("not implemented")}_linkToIdToken(t,e){return ke("not implemented")}_getReauthenticationResolver(t){return ke("not implemented")}}async function Jn(t,e){return Be(t,"POST","/v1/accounts:signUp",e)}async function Xn(t,e){return qe(t,"POST","/v1/accounts:signInWithPassword",je(t,e))}class Qn extends Gn{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=t,this._password=e,this._tenantId=r}static _fromEmailAndPassword(t,e){return new Qn(t,e,"password")}static _fromEmailAndCode(t,e){return new Qn(t,e,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t;if(null!==e&&void 0!==e&&e.email&&null!==e&&void 0!==e&&e.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Hn(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Xn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return qe(t,"POST","/v1/accounts:signInWithEmailLink",je(t,e))}(t,{email:this._email,oobCode:this._password});default:Ie(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Hn(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Jn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return qe(t,"POST","/v1/accounts:signInWithEmailLink",je(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Ie(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Yn(t,e){return qe(t,"POST","/v1/accounts:signInWithIdp",je(t,e))}class $n extends Gn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new $n(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ie("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t,{providerId:n,signInMethod:r}=e,i=fe(e,me);if(!n||!r)return null;const s=new $n(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(t){return Yn(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Yn(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Yn(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=D(e)}return t}}async function Zn(t,e){return Be(t,"POST","/v1/accounts:sendVerificationCode",je(t,e))}const tr={USER_NOT_FOUND:"user-not-found"};class er extends Gn{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new er({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new er({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return qe(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await qe(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,e));if(n.temporaryProof)throw Ge(t,"account-exists-with-different-credential",n);return n}(t,a({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return qe(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,a(a({},e),{},{operation:"REAUTH"})),tr)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:r}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:r}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"===typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}=t;return n||e||r||i?new er({verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class nr{constructor(t){var e,n,r,i,s,o;const a=L(M(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ce(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=L(M(t)).link,n=e?L(M(e)).deep_link_id:null,r=L(M(t)).deep_link_id;return(r?L(M(r)).link:null)||r||n||e||t}(t);try{return new nr(e)}catch(n){return null}}}class rr{constructor(){this.providerId=rr.PROVIDER_ID}static credential(t,e){return Qn._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=nr.parseLink(e);return Ce(n,"argument-error"),Qn._fromEmailAndCode(t,n.code,n.tenantId)}}rr.PROVIDER_ID="password",rr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",rr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ir{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class sr extends ir{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class or extends sr{constructor(){super("facebook.com")}static credential(t){return $n._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return or.credentialFromTaggedObject(t)}static credentialFromError(t){return or.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch(n){return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com",or.PROVIDER_ID="facebook.com";class ar extends sr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return $n._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return ar.credentialFromTaggedObject(t)}static credentialFromError(t){return ar.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ar.credential(n,r)}catch(i){return null}}}ar.GOOGLE_SIGN_IN_METHOD="google.com",ar.PROVIDER_ID="google.com";class cr extends sr{constructor(){super("github.com")}static credential(t){return $n._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return cr.credentialFromTaggedObject(t)}static credentialFromError(t){return cr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return cr.credential(e.oauthAccessToken)}catch(n){return null}}}cr.GITHUB_SIGN_IN_METHOD="github.com",cr.PROVIDER_ID="github.com";class lr extends sr{constructor(){super("twitter.com")}static credential(t,e){return $n._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return lr.credentialFromTaggedObject(t)}static credentialFromError(t){return lr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return lr.credential(n,r)}catch(i){return null}}}lr.TWITTER_SIGN_IN_METHOD="twitter.com",lr.PROVIDER_ID="twitter.com";class ur{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await un._fromIdTokenResponse(t,n,r),s=hr(n);return new ur({user:i,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const r=hr(n);return new ur({user:t,providerId:r,_tokenResponse:n,operationType:e})}}function hr(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class dr extends k{constructor(t,e,n,r){var i;super(e.code,e.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,dr.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,r){return new dr(t,e,n,r)}}function fr(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw dr._fromErrorAndOperation(t,n,e,r);throw n})}async function pr(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await nn(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ur._forOperation(t,"link",r)}async function gr(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=t;if(Qt(r.app))return Promise.reject(Se(r));const i="reauthenticate";try{const s=await nn(t,fr(r,i,e,t),n);Ce(s.idToken,r,"internal-error");const o=tn(s.idToken);Ce(o,r,"internal-error");const{sub:a}=o;return Ce(t.uid===a,r,"user-mismatch"),ur._forOperation(t,i,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Ie(r,"user-mismatch"),s}}async function mr(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qt(t.app))return Promise.reject(Se(t));const r="signIn",i=await fr(t,r,e),s=await ur._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function yr(t,e){return Be(t,"POST","/v2/accounts/mfaEnrollment:start",je(t,e))}new WeakMap;const vr="__sak";class wr{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(vr,"1"),this.storage.removeItem(vr),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class _r extends wr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cn(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),r=this.localCache[e];n!==r&&t(e,r,n)}}onStorageEvent(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.key)return void this.forAllChangedKeys((t,e,n)=>{this.notifyListeners(t,n)});const n=t.key;e?this.detachListener():this.stopPolling();const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},i=this.storage.getItem(n);An()&&i!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,10):r()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const r of Array.from(n))r(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}_r.type="LOCAL";const Er=_r;function Ir(t){var e,n;const r=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(e=null===(n=document.cookie.match(i))||void 0===n?void 0:n[1])&&void 0!==e?e:null}function br(t){const e="http:"===window.location.protocol;return"".concat(e?"__dev_":"__HOST-","FIREBASE_").concat(t.split(":")[3])}class Tr{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(t){if(void 0===typeof window)return t;const e=new URL("".concat(window.location.origin,"/__cookies__"));return e.searchParams.set("finalTarget",t),e}async _isAvailable(){var t;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(t=navigator.cookieEnabled)||void 0===t||t))}async _set(t,e){}async _get(t){if(!this._isAvailable())return null;const e=br(t);if(window.cookieStore){const t=await window.cookieStore.get(e);return null===t||void 0===t?void 0:t.value}return Ir(e)}async _remove(t){if(!this._isAvailable())return;if(!await this._get(t))return;const e=br(t);document.cookie="".concat(e,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(t,e){if(!this._isAvailable())return;const n=br(t);if(window.cookieStore){const t=t=>{const r=t.changed.find(t=>t.name===n);r&&e(r.value);t.deleted.find(t=>t.name===n)&&e(null)},r=()=>window.cookieStore.removeEventListener("change",t);return this.listenerUnsubscribes.set(e,r),window.cookieStore.addEventListener("change",t)}let r=Ir(n);const i=setInterval(()=>{const t=Ir(n);t!==r&&(e(t),r=t)},1e3);this.listenerUnsubscribes.set(e,()=>clearInterval(i))}_removeListener(t,e){const n=this.listenerUnsubscribes.get(e);n&&(n(),this.listenerUnsubscribes.delete(e))}}Tr.type="COOKIE";class Sr extends wr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Sr.type="SESSION";const Ar=Sr;class Cr{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(e=>e.isListeningto(t));if(e)return e;const n=new Cr(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:r,data:i}=e.data,s=this.handlersMap[r];if(null===s||void 0===s||!s.size)return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async t=>t(e.origin,i)),a=await function(t){return Promise.all(t.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function kr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<e;r++)n+=Math.floor(10*Math.random());return t+n}Cr.receivers=[];class Rr{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const c=kr("",20);r.port1.start();const l=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(e.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Nr(){return window}function Or(){return"undefined"!==typeof Nr().WorkerGlobalScope&&"function"===typeof Nr().importScripts}const Pr="firebaseLocalStorageDb",Dr="firebaseLocalStorage",Lr="fbase_key";class Mr{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function xr(t,e){return t.transaction([Dr],e?"readwrite":"readonly").objectStore(Dr)}function Vr(){const t=indexedDB.open(Pr,1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const e=t.result;try{e.createObjectStore(Dr,{keyPath:Lr})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Dr)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Pr);return new Mr(t).toPromise()}(),e(await Vr()))})})}async function Ur(t,e,n){const r=xr(t,!0).put({[Lr]:e,value:n});return new Mr(r).toPromise()}function Fr(t,e){const n=xr(t,!0).delete(e);return new Mr(n).toPromise()}class jr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Vr()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(n){if(e++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Or()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cr._getInstance(Or()?self:null),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){var t;if(null===(t=navigator)||void 0===t||!t.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Rr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(t=n[0])&&void 0!==t&&t.fulfilled&&null!==(e=n[0])&&void 0!==e&&e.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=navigator)||void 0===t||null===(t=t.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Vr();return await Ur(t,vr,"1"),await Fr(t,vr),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ur(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(e=>async function(t,e){const n=xr(t,!1).get(e),r=await new Mr(n).toPromise();return void 0===r?null:r.value}(e,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>Fr(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(t=>{const e=xr(t,!1).getAll();return new Mr(e).toPromise()});if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:r,value:i}of t)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),e.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),e.push(r));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const r of Array.from(n))r(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}jr.type="LOCAL";const Br=jr;function Hr(t,e){return Be(t,"POST","/v2/accounts/mfaSignIn:start",je(t,e))}xn("rcb"),new Le(3e4,6e4);const qr="recaptcha";async function Wr(t,e,n){if(!t._getRecaptchaConfig())try{await qn(t)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof e?{phoneNumber:e}:e,"session"in i){const e=i.session;if("phoneNumber"in i){Ce("enroll"===e.type,t,"internal-error");const r={idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Hn(t,r,"mfaSmsEnrollment",async(t,e)=>{if(e.phoneEnrollmentInfo.captchaResponse===Fn){Ce((null===n||void 0===n?void 0:n.type)===qr,t,"argument-error");return yr(t,await zr(t,e,n))}return yr(t,e)},"PHONE_PROVIDER");return(await s.catch(t=>Promise.reject(t))).phoneSessionInfo.sessionInfo}{var r;Ce("signin"===e.type,t,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Ce(s,t,"missing-multi-factor-info");const o={mfaPendingCredential:e.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Hn(t,o,"mfaSmsSignIn",async(t,e)=>{if(e.phoneSignInInfo.captchaResponse===Fn){Ce((null===n||void 0===n?void 0:n.type)===qr,t,"argument-error");return Hr(t,await zr(t,e,n))}return Hr(t,e)},"PHONE_PROVIDER");return(await a.catch(t=>Promise.reject(t))).phoneResponseInfo.sessionInfo}}{const e={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Hn(t,e,"sendVerificationCode",async(t,e)=>{if(e.captchaResponse===Fn){Ce((null===n||void 0===n?void 0:n.type)===qr,t,"argument-error");return Zn(t,await zr(t,e,n))}return Zn(t,e)},"PHONE_PROVIDER");return(await r.catch(t=>Promise.reject(t))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function zr(t,e,n){Ce(n.type===qr,t,"argument-error");const r=await n.verify();Ce("string"===typeof r,t,"argument-error");const i=a({},e);if("phoneEnrollmentInfo"in i){const t=i.phoneEnrollmentInfo.phoneNumber,e=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:r,captchaResponse:e,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const t=i.phoneSignInInfo.captchaResponse,e=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:t,clientType:e,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Kr{constructor(t){this.providerId=Kr.PROVIDER_ID,this.auth=Pn(t)}verifyPhoneNumber(t,e){return Wr(this.auth,t,U(e))}static credential(t,e){return er._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Kr.credentialFromTaggedObject(e)}static credentialFromError(t){return Kr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?er._fromTokenResponse(n,r):null}}function Gr(t,e){return e?dn(e):(Ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Kr.PROVIDER_ID="phone",Kr.PHONE_SIGN_IN_METHOD="phone";class Jr extends Gn{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Yn(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Yn(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Yn(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Xr(t){return mr(t.auth,new Jr(t),t.bypassAuthState)}function Qr(t){const{auth:e,user:n}=t;return Ce(n,e,"internal-error"),gr(n,new Jr(t),t.bypassAuthState)}async function Yr(t){const{auth:e,user:n}=t;return Ce(n,e,"internal-error"),pr(n,new Jr(t),t.bypassAuthState)}class $r{constructor(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Xr;case"linkViaPopup":case"linkViaRedirect":return Yr;case"reauthViaPopup":case"reauthViaRedirect":return Qr;default:Ie(this.auth,"internal-error")}}resolve(t){Re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zr=new Le(2e3,1e4);class ti extends $r{constructor(t,e,n,r,i){super(t,e,r,i),this.provider=n,this.authWindow=null,this.pollId=null,ti.currentPopupAction&&ti.currentPopupAction.cancel(),ti.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Ce(t,this.auth,"internal-error"),t}async onExecution(){Re(1===this.filter.length,"Popup operations only handle one event");const t=kr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(be(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(be(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ti.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e;null!==(e=this.authWindow)&&void 0!==e&&null!==(e=e.window)&&void 0!==e&&e.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(be(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(t,Zr.get())};t()}}ti.currentPopupAction=null;const ei=new Map;class ni extends $r{constructor(t,e){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let t=ei.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=si(e),r=ii(t);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}ei.set(this.auth._key(),t)}return this.bypassAuthState||ei.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ri(t,e){ei.set(t._key(),e)}function ii(t){return dn(t._redirectPersistence)}function si(t){return gn("pendingRedirect",t.config.apiKey,t.name)}async function oi(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qt(t.app))return Promise.reject(Se(t));const r=Pn(t),i=Gr(r,e),s=new ni(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}class ai{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return li(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!li(t)){var n;const r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(be(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ci(t))}saveEventToCache(t){this.cachedEventUids.add(ci(t)),this.lastProcessedEventTime=Date.now()}}function ci(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(t=>t).join("-")}function li(t){let{type:e,error:n}=t;return"unknown"===e&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const ui=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hi=/^https?/;async function di(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t){return Be(t,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(t);for(const r of e)try{if(fi(r))return}catch(n){}Ie(t,"unauthorized-domain")}function fi(t){const e=Ne(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return""===i.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!hi.test(n))return!1;if(ui.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const pi=new Le(3e4,6e4);function gi(){const t=Nr().___jsl;if(null!==t&&void 0!==t&&t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}function mi(t){return new Promise((e,n)=>{var r,i;function s(){gi(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gi(),n(be(t,"network-request-failed"))},timeout:pi.get()})}if(null!==(r=Nr().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)e(gapi.iframes.getContext());else{if(null===(i=Nr().gapi)||void 0===i||!i.load){const e=xn("iframefcb");return Nr()[e]=()=>{gapi.load?s():n(be(t,"network-request-failed"))},Mn("".concat(Ln.gapiScript,"?onload=").concat(e)).catch(t=>n(t))}s()}}).catch(t=>{throw yi=null,t})}let yi=null;const vi=new Le(5e3,15e3),wi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_i=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ei(t){const e=t.config;Ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Me(e,"emulator/auth/iframe"):"https://".concat(t.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:e.apiKey,appName:t.name,v:Zt},i=_i.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(D(r).slice(1))}async function Ii(t){const e=await function(t){return yi=yi||mi(t),yi}(t),n=Nr().gapi;return Ce(n,t,"internal-error"),e.open({where:document.body,url:Ei(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wi,dontclear:!0},e=>new Promise(async(n,r)=>{await e.restyle({setHideOnLeave:!1});const i=be(t,"network-request-failed"),s=Nr().setTimeout(()=>{r(i)},vi.get());function o(){Nr().clearTimeout(s),n(e)}e.ping(o).then(o,()=>{r(i)})}))}const bi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ti{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Si(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l=a(a({},bi),{},{width:r.toString(),height:i.toString(),top:s,left:o}),u=T().toLowerCase();n&&(c=_n(u)?"_blank":n),vn(u)&&(e=e||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce((t,e)=>{let[n,r]=e;return"".concat(t).concat(n,"=").concat(r,",")},"");if(function(){var t;return Sn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T())&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(u)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",c),new Ti(null);const d=window.open(e||"",c,h);Ce(d,t,"popup-blocked");try{d.focus()}catch(f){}return new Ti(d)}const Ai="__/auth/handler",Ci="emulator/auth/handler",ki=encodeURIComponent("fac");async function Ri(t,e,n,r,i,s){Ce(t.config.authDomain,t,"auth-domain-config-required"),Ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Zt,eventId:i};if(e instanceof ir){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof sr){const t=e.getScopes().filter(t=>""!==t);t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const c=await t._getAppCheckToken(),l=c?"#".concat(ki,"=").concat(encodeURIComponent(c)):"";return"".concat(function(t){let{config:e}=t;if(!e.emulator)return"https://".concat(e.authDomain,"/").concat(Ai);return Me(e,Ci)}(t),"?").concat(D(a).slice(1)).concat(l)}const Ni="webStorageSupport";const Oi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ar,this._completeRedirectFn=oi,this._overrideRedirectResult=ri}async _openPopup(t,e,n,r){var i;Re(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Si(t,await Ri(t,e,n,Ne(),r),kr())}async _openRedirect(t,e,n,r){await this._originValidation(t);return function(t){Nr().location.href=t}(await Ri(t,e,n,Ne(),r)),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Re(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await Ii(t),n=new ai(t);return e.register("authEvent",e=>{Ce(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event");return{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ni,{type:Ni},n=>{var r;const i=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[Ni];void 0!==i&&e(!!i),Ie(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=di(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Cn()||wn()||Sn()}};var Pi="@firebase/auth",Di="1.12.0";class Li{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(e=>{t((null===e||void 0===e?void 0:e.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Mi=y("authIdTokenMaxAge")||300;let xi=null;var Vi;Ln={loadJS:t=>new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=t=>{const e=be("internal-error");e.customData=t,n(e)},r.type="text/javascript",r.charset="UTF-8",function(){var t,e;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Vi="Browser",Jt(new F("auth",(t,e)=>{let{options:n}=e;const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:Vi,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kn(Vi)},l=new On(r,i,s,c);return function(t,e){const n=(null===e||void 0===e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(dn);null!==e&&void 0!==e&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,null===e||void 0===e?void 0:e.popupRedirectResolver)}(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),Jt(new F("auth-internal",t=>(t=>new Li(t))(Pn(t.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),ne(Pi,Di,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Vi)),ne(Pi,Di,"esm2020");var Ui,Fi="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},ji={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(t,e,n){n||(n=0);const r=Array(16);if("string"===typeof e)for(var i=0;i<16;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];let s,o=t.g[3];s=e+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(e=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=e+(s<<12&4294967295|s>>>20),s=i+(n^o&(e^n))+r[2]+606105819&4294967295,s=n+(e^(i=o+(s<<17&4294967295|s>>>15))&(o^e))+r[3]+3250441966&4294967295,s=e+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(e=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=e+(s<<12&4294967295|s>>>20),s=i+(n^o&(e^n))+r[6]+2821735955&4294967295,s=n+(e^(i=o+(s<<17&4294967295|s>>>15))&(o^e))+r[7]+4249261313&4294967295,s=e+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(e=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=e+(s<<12&4294967295|s>>>20),s=i+(n^o&(e^n))+r[10]+4294925233&4294967295,s=n+(e^(i=o+(s<<17&4294967295|s>>>15))&(o^e))+r[11]+2304563134&4294967295,s=e+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(e=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=e+(s<<12&4294967295|s>>>20),s=i+(n^o&(e^n))+r[14]+2792965006&4294967295,s=n+(e^(i=o+(s<<17&4294967295|s>>>15))&(o^e))+r[15]+1236535329&4294967295,s=e+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((e=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=e+(s<<9&4294967295|s>>>23),s=i+(e^n&(o^e))+r[11]+643717713&4294967295,s=n+(o^e&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=e+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((e=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=e+(s<<9&4294967295|s>>>23),s=i+(e^n&(o^e))+r[15]+3634488961&4294967295,s=n+(o^e&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=e+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((e=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=e+(s<<9&4294967295|s>>>23),s=i+(e^n&(o^e))+r[3]+4107603335&4294967295,s=n+(o^e&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=e+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((e=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=e+(s<<9&4294967295|s>>>23),s=i+(e^n&(o^e))+r[7]+1735328473&4294967295,s=n+(o^e&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=e+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((e=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=e+(s<<11&4294967295|s>>>21),s=i+(o^e^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^e)+r[14]+4259657740&4294967295,s=e+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((e=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=e+(s<<11&4294967295|s>>>21),s=i+(o^e^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^e)+r[10]+3200236656&4294967295,s=e+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((e=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=e+(s<<11&4294967295|s>>>21),s=i+(o^e^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^e)+r[6]+76029189&4294967295,s=e+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((e=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=e+(s<<11&4294967295|s>>>21),s=i+(o^e^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^e)+r[2]+3299628645&4294967295,s=e+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((e=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=e+(s<<10&4294967295|s>>>22),s=i+(e^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~e))+r[5]+4237533241&4294967295,s=e+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((e=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=e+(s<<10&4294967295|s>>>22),s=i+(e^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~e))+r[1]+2240044497&4294967295,s=e+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((e=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=e+(s<<10&4294967295|s>>>22),s=i+(e^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~e))+r[13]+1309151649&4294967295,s=e+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((e=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=e+(s<<10&4294967295|s>>>22),s=i+(e^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+o&4294967295}function r(t,e){this.h=e;const n=[];let r=!0;for(let i=t.length-1;i>=0;i--){const s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.F=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.D=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}(e,function(){this.blockSize=-1}),e.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.v=function(t,e){void 0===e&&(e=t.length);const r=e-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<e;){if(0==s)for(;o<=r;)n(this,t,o),o+=this.blockSize;if("string"===typeof t){for(;o<e;)if(i[s++]=t.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<e;)if(i[s++]=t[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=e},e.prototype.A=function(){var t=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;e=8*this.o;for(var n=t.length-8;n<t.length;++n)t[n]=255&e,e/=256;for(this.v(t),t=Array(16),e=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)t[e++]=this.g[n]>>>r&255;return t};var i={};function s(t){return-128<=t&&t<128?function(t,e){var n=i;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(t){return new r([0|t],t<0?-1:0)}):new r([0|t],t<0?-1:0)}function o(t){if(isNaN(t)||!isFinite(t))return a;if(t<0)return d(o(-t));const e=[];let n=1;for(let r=0;t>=n;r++)e[r]=t/n|0,n*=4294967296;return new r(e,0)}var a=s(0),c=s(1),l=s(16777216);function u(t){if(0!=t.h)return!1;for(let e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function h(t){return-1==t.h}function d(t){const e=t.g.length,n=[];for(let r=0;r<e;r++)n[r]=~t.g[r];return new r(n,~t.h).add(c)}function f(t,e){return t.add(d(e))}function p(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function g(t,e){this.g=t,this.h=e}function m(t,e){if(u(e))throw Error("division by zero");if(u(t))return new g(a,a);if(h(t))return e=m(d(t),e),new g(d(e.g),d(e.h));if(h(e))return e=m(t,d(e)),new g(d(e.g),e.h);if(t.g.length>30){if(h(t)||h(e))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=e;r.l(t)<=0;)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var l=s.add(r);l.l(t)<=0&&(i=i.add(n),s=l),r=v(r,1),n=v(n,1)}return e=f(t,i.j(e)),new g(i,e)}for(i=a;t.l(e)>=0;){for(n=Math.max(1,Math.floor(t.m()/e.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),l=(s=o(n)).j(e);h(l)||l.l(t)>0;)l=(s=o(n-=r)).j(e);u(s)&&(s=c),i=i.add(s),t=f(t,l)}return new g(i,t)}function y(t){const e=t.g.length+1,n=[];for(let r=0;r<e;r++)n[r]=t.i(r)<<1|t.i(r-1)>>>31;return new r(n,t.h)}function v(t,e){const n=e>>5;e%=32;const i=t.g.length-n,s=[];for(let r=0;r<i;r++)s[r]=e>0?t.i(r+n)>>>e|t.i(r+n+1)<<32-e:t.i(r+n);return new r(s,t.h)}(t=r.prototype).m=function(){if(h(this))return-d(this).m();let t=0,e=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);t+=(r>=0?r:4294967296+r)*e,e*=4294967296}return t},t.toString=function(t){if((t=t||10)<2||36<t)throw Error("radix out of range: "+t);if(u(this))return"0";if(h(this))return"-"+d(this).toString(t);const e=o(Math.pow(t,6));var n=this;let r="";for(;;){const i=m(n,e).g;let s=(((n=f(n,i.j(e))).g.length>0?n.g[0]:n.h)>>>0).toString(t);if(u(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},t.i=function(t){return t<0?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return h(t=f(this,t))?-1:u(t)?0:1},t.abs=function(){return h(this)?d(this):this},t.add=function(t){const e=Math.max(this.g.length,t.g.length),n=[];let i=0;for(let r=0;r<=e;r++){let e=i+(65535&this.i(r))+(65535&t.i(r)),s=(e>>>16)+(this.i(r)>>>16)+(t.i(r)>>>16);i=s>>>16,e&=65535,s&=65535,n[r]=s<<16|e}return new r(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(u(this)||u(t))return a;if(h(this))return h(t)?d(this).j(d(t)):d(d(this).j(t));if(h(t))return d(this.j(d(t)));if(this.l(l)<0&&t.l(l)<0)return o(this.m()*t.m());const e=this.g.length+t.g.length,n=[];for(var i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let e=0;e<t.g.length;e++){const r=this.i(i)>>>16,s=65535&this.i(i),o=t.i(e)>>>16,a=65535&t.i(e);n[2*i+2*e]+=s*a,p(n,2*i+2*e),n[2*i+2*e+1]+=r*a,p(n,2*i+2*e+1),n[2*i+2*e+1]+=s*o,p(n,2*i+2*e+1),n[2*i+2*e+2]+=r*o,p(n,2*i+2*e+2)}for(t=0;t<e;t++)n[t]=n[2*t+1]<<16|n[2*t];for(t=e;t<2*e;t++)n[t]=0;return new r(n,0)},t.B=function(t){return m(this,t).h},t.and=function(t){const e=Math.max(this.g.length,t.g.length),n=[];for(let r=0;r<e;r++)n[r]=this.i(r)&t.i(r);return new r(n,this.h&t.h)},t.or=function(t){const e=Math.max(this.g.length,t.g.length),n=[];for(let r=0;r<e;r++)n[r]=this.i(r)|t.i(r);return new r(n,this.h|t.h)},t.xor=function(t){const e=Math.max(this.g.length,t.g.length),n=[];for(let r=0;r<e;r++)n[r]=this.i(r)^t.i(r);return new r(n,this.h^t.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,ji.Md5=e,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return d(t(e.substring(1),n));if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=o(Math.pow(n,8));let i=a;for(let a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a);const t=parseInt(e.substring(a,a+s),n);s<8?(s=o(Math.pow(n,s)),i=i.j(s).add(o(t))):(i=i.j(r),i=i.add(o(t)))}return i},Ui=ji.Integer=r}).apply("undefined"!==typeof Fi?Fi:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Bi,Hi,qi,Wi,zi,Ki,Gi,Ji,Xi="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Qi={};(function(){var t,e=Object.defineProperty;var n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Xi&&Xi];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(t,r){if(r)t:{var i=n;t=t.split(".");for(var s=0;s<t.length-1;s++){var o=t[s];if(!(o in i))break t;i=i[o]}(r=r(s=i[t=t[t.length-1]]))!=s&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(t){return t||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(t){return t||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(t){return t||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push([e,t[e]]);return n}});var i=i||{},s=this||self;function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){return(c=a).apply(null,arguments)}function l(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Ob=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?t=>t&&AsyncContext.Snapshot.wrap(t):t=>t;function d(t){const e=t.length;if(e>0){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function f(t,e){for(let r=1;r<arguments.length;r++){const e=arguments[r];var n=typeof e;if("array"==(n="object"!=n?n:e?Array.isArray(e)?"array":n:"null")||"object"==n&&"number"==typeof e.length){n=t.length||0;const r=e.length||0;t.length=n+r;for(let i=0;i<r;i++)t[n+i]=e[i]}else t.push(e)}}function p(t){s.setTimeout(()=>{throw t},0)}function g(){var t=_;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var m=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return this.h>0?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new y,t=>t.reset());class y{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let v,w=!1,_=new class{constructor(){this.h=this.g=null}add(t,e){const n=m.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},E=()=>{const t=Promise.resolve(void 0);v=()=>{t.then(I)}};function I(){for(var t;t=g();){try{t.h.call(t.g)}catch(n){p(n)}var e=m;e.j(t),e.h<100&&(e.h++,t.next=e.g,e.g=t)}w=!1}function b(){this.u=this.u,this.C=this.C}function T(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}b.prototype.u=!1,b.prototype.dispose=function(){this.u||(this.u=!0,this.N())},b.prototype[Symbol.dispose]=function(){this.dispose()},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},T.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};s.addEventListener("test",t,e),s.removeEventListener("test",t,e)}catch(n){}return t}();function A(t){return/^[\s\xa0]*$/.test(t)}function C(t,e){T.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t&&this.init(t,e)}u(C,T),C.prototype.init=function(t,e){const n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;this.target=t.target||t.srcElement,this.g=e,(e=t.relatedTarget)||("mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement)),this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=t.pointerType,this.state=t.state,this.i=t,t.defaultPrevented&&C.Z.h.call(this)},C.prototype.h=function(){C.Z.h.call(this);const t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var k="closure_listenable_"+(1e6*Math.random()|0),R=0;function N(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=i,this.key=++R,this.da=this.fa=!1}function O(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function P(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function D(t){const e={};for(const n in t)e[n]=t[n];return e}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let e=0;e<L.length;e++)n=L[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function x(t){this.src=t,this.g={},this.h=0}function V(t,e){const n=e.type;if(n in t.g){var r,i=t.g[n],s=Array.prototype.indexOf.call(i,e,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(O(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function U(t,e,n,r){for(let i=0;i<t.length;++i){const s=t[i];if(!s.da&&s.listener==e&&s.capture==!!n&&s.ha==r)return i}return-1}x.prototype.add=function(t,e,n,r,i){const s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);const o=U(t,e,r,i);return o>-1?(e=t[o],n||(e.fa=!1)):((e=new N(e,this.src,s,!!r,i)).fa=n,t.push(e)),e};var F="closure_lm_"+(1e6*Math.random()|0),j={};function B(t,e,n,r,i){if(r&&r.once)return q(t,e,n,r,i);if(Array.isArray(e)){for(let s=0;s<e.length;s++)B(t,e[s],n,r,i);return null}return n=Q(n),t&&t[k]?t.J(e,n,o(r)?!!r.capture:!!r,i):H(t,e,n,!1,r,i)}function H(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");const a=o(i)?!!i.capture:!!i;let c=J(t);if(c||(t[F]=c=new x(t)),(n=c.add(e,n,r,a,s)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}const e=G;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)S||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(K(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function q(t,e,n,r,i){if(Array.isArray(e)){for(let s=0;s<e.length;s++)q(t,e[s],n,r,i);return null}return n=Q(n),t&&t[k]?t.K(e,n,o(r)?!!r.capture:!!r,i):H(t,e,n,!0,r,i)}function W(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)W(t,e[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=Q(n),t&&t[k]?(t=t.i,(s=String(e).toString())in t.g&&((n=U(e=t.g[s],n,r,i))>-1&&(O(e[n]),Array.prototype.splice.call(e,n,1),0==e.length&&(delete t.g[s],t.h--)))):t&&(t=J(t))&&(e=t.g[e.toString()],t=-1,e&&(t=U(e,n,r,i)),(n=t>-1?e[t]:null)&&z(n))}function z(t){if("number"!==typeof t&&t&&!t.da){var e=t.src;if(e&&e[k])V(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(K(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=J(e))?(V(n,t),0==n.h&&(n.src=null,e[F]=null)):O(t)}}}function K(t){return t in j?j[t]:j[t]="on"+t}function G(t,e){if(t.da)t=!0;else{e=new C(e,this);const n=t.listener,r=t.ha||t.src;t.fa&&z(t),t=n.call(r,e)}return t}function J(t){return(t=t[F])instanceof x?t:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function Q(t){return"function"===typeof t?t:(t[X]||(t[X]=function(e){return t.handleEvent(e)}),t[X])}function Y(){b.call(this),this.i=new x(this),this.M=this,this.G=null}function $(t,e){var n,r=t.G;if(r)for(n=[];r;r=r.G)n.push(r);if(t=t.M,r=e.type||e,"string"===typeof e)e=new T(e,t);else if(e instanceof T)e.target=e.target||t;else{var i=e;M(e=new T(r,t),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=e.g=n[o],i=Z(s,r,!0,e)&&i;if(s=e.g=t,i=Z(s,r,!0,e)&&i,i=Z(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)s=e.g=n[o],i=Z(s,r,!1,e)&&i}function Z(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();let i=!0;for(let s=0;s<e.length;++s){const o=e[s];if(o&&!o.da&&o.capture==n){const e=o.listener,n=o.ha||o.src;o.fa&&V(t.i,o),i=!1!==e.call(n,r)&&i}}return i&&!r.defaultPrevented}function tt(t){t.g=function(t,e){if("function"!==typeof t){if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=c(t.handleEvent,t)}return Number(e)>2147483647?-1:s.setTimeout(t,e||0)}(()=>{t.g=null,t.i&&(t.i=!1,tt(t))},t.l);const e=t.h;t.h=null,t.m.apply(null,e)}u(Y,b),Y.prototype[k]=!0,Y.prototype.removeEventListener=function(t,e,n,r){W(this,t,e,n,r)},Y.prototype.N=function(){if(Y.Z.N.call(this),this.i){var t=this.i;for(const e in t.g){const n=t.g[e];for(let t=0;t<n.length;t++)O(n[t]);delete t.g[e],t.h--}}this.G=null},Y.prototype.J=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Y.prototype.K=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};class et extends b{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:tt(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nt(t){b.call(this),this.h=t,this.g={}}u(nt,b);var rt=[];function it(t){P(t.g,function(t,e){this.g.hasOwnProperty(e)&&z(t)},t),t.g={}}nt.prototype.N=function(){nt.Z.N.call(this),it(this)},nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var st=s.JSON.stringify,ot=s.JSON.parse,at=class{stringify(t){return s.JSON.stringify(t,void 0)}parse(t){return s.JSON.parse(t,void 0)}};function ct(){}function lt(){}var ut={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ht(){T.call(this,"d")}function dt(){T.call(this,"c")}u(ht,T),u(dt,T);var ft={},pt=null;function gt(){return pt=pt||new Y}function mt(t){T.call(this,ft.Ia,t)}function yt(t){const e=gt();$(e,new mt(e))}function vt(t,e){T.call(this,ft.STAT_EVENT,t),this.stat=e}function wt(t){const e=gt();$(e,new vt(e,t))}function _t(t,e){T.call(this,ft.Ja,t),this.size=e}function Et(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},e)}function It(){this.g=!0}function bt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{const s=JSON.parse(e);if(s)for(t=0;t<s.length;t++)if(Array.isArray(s[t])){var n=s[t];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let t=1;t<r.length;t++)r[t]=""}}}return st(s)}catch(s){return e}}(t,n)+(r?" "+r:"")})}ft.Ia="serverreachability",u(mt,T),ft.STAT_EVENT="statevent",u(vt,T),ft.Ja="timingevent",u(_t,T),It.prototype.ua=function(){this.g=!1},It.prototype.info=function(){};var Tt,St={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},At={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ct(){}function kt(t){return encodeURIComponent(String(t))}function Rt(t){var e=1;t=t.split(":");const n=[];for(;e>0&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Nt(t,e,n,r){this.j=t,this.i=e,this.l=n,this.S=r||1,this.V=new nt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ot}function Ot(){this.i=null,this.g="",this.h=!1}u(Ct,ct),Ct.prototype.g=function(){return new XMLHttpRequest},Tt=new Ct;var Pt={},Dt={};function Lt(t,e,n){t.M=1,t.A=se(te(e)),t.u=n,t.R=!0,Mt(t,null)}function Mt(t,e){t.F=Date.now(),Ut(t),t.B=te(t.A);var n=t.B,r=t.S;Array.isArray(r)||(r=[String(r)]),we(n.i,"t",r),t.C=0,n=t.j.L,t.h=new Ot,t.g=on(t.j,n?e:null,!t.u),t.P>0&&(t.O=new et(c(t.Y,t,t.g),t.P)),e=t.V,n=t.g,r=t.ba;var i="readystatechange";Array.isArray(i)||(i&&(rt[0]=i.toString()),i=rt);for(let s=0;s<i.length;s++){const t=B(n,i[s],r||e.handleEvent,!1,e.h||e);if(!t)break;e.g[t.key]=t}e=t.J?D(t.J):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.B,t.v,t.u,e)):(t.v="GET",t.g.ea(t.B,t.v,null,e)),yt(),function(t,e,n,r,i,s){t.info(function(){if(t.g)if(s){var o="",a=s.split("&");for(let t=0;t<a.length;t++){var c=a[t].split("=");if(c.length>1){const t=c[0];c=c[1];const e=t.split("_");o=e.length>=2&&"type"==e[1]?o+(t+"=")+c+"&":o+(t+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.i,t.v,t.B,t.l,t.S,t.u)}function xt(t){return!!t.g&&("GET"==t.v&&2!=t.M&&t.j.Aa)}function Vt(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Dt:(n=Number(e.substring(n,r)),isNaN(n)?Pt:(r+=1)+n>e.length?Dt:(e=e.slice(r,r+n),t.C=r+n,e))}function Ut(t){t.T=Date.now()+t.H,Ft(t,t.H)}function Ft(t,e){if(null!=t.D)throw Error("WatchDog timer not null");t.D=Et(c(t.aa,t),e)}function jt(t){t.D&&(s.clearTimeout(t.D),t.D=null)}function Bt(t){0==t.j.I||t.K||tn(t.j,t)}function Ht(t){jt(t);var e=t.O;e&&"function"==typeof e.dispose&&e.dispose(),t.O=null,it(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.dispose())}function qt(t,e){try{var n=t.j;if(0!=n.I&&(n.g==t||Jt(n.h,t)))if(!t.L&&Jt(n.h,t)&&3==n.I){try{var r=n.Ba.g.parse(e)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.v){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ze(n),qe(n)}Qe(n),wt(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Et(c(n.Va,n),6e3));Gt(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((t.L||n.g==t)&&Ze(n),!A(e))for(i=n.Ba.g.parse(e),e=0;e<i.length;e++){let c=i[e];const u=c[0];if(!(u<=n.K))if(n.K=u,c=c[1],2==n.I)if("c"==c[0]){n.M=c[1],n.ba=c[2];const e=c[3];null!=e&&(n.ka=e,n.j.info("VER="+n.ka));const i=c[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=c[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Xt(s,s.h),s.h=null))}if(r.G){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.wa=t,ie(r.J,r.G,t))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-t.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=t;if((r=n).na=sn(r,r.L?r.ba:null,r.W),o.L){Qt(r.h,o);var a=o,l=r.O;l&&(a.H=l),a.D&&(jt(a),Ut(a)),r.g=o}else Xe(r);n.i.length>0&&ze(n)}else"stop"!=c[0]&&"close"!=c[0]||nn(n,7);else 3==n.I&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?nn(n,7):He(n):"noop"!=c[0]&&n.l&&n.l.qa(c),n.A=0)}yt()}catch(u){}}Nt.prototype.ba=function(t){t=t.target;const e=this.O;e&&3==Ue(t)?e.j():this.Y(t)},Nt.prototype.Y=function(t){try{if(t==this.g)t:{const c=Ue(this.g),l=this.g.ya();this.g.ca();if(!(c<3)&&(3!=c||this.g&&(this.h.h||this.g.la()||Fe(this.g)))){this.K||4!=c||7==l||yt(),jt(this);var e=this.g.ca();this.X=e;var n=function(t){if(!xt(t))return t.g.la();const e=Fe(t.g);if(""===e)return"";let n="";const r=e.length,i=4==Ue(t.g);if(!t.h.i){if("undefined"===typeof TextDecoder)return Ht(t),Bt(t),"";t.h.i=new s.TextDecoder}for(let s=0;s<r;s++)t.h.h=!0,n+=t.h.i.decode(e[s],{stream:!(i&&s==r-1)});return e.length=0,t.h.g+=n,t.C=0,t.h.g}(this);if(this.o=200==e,function(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.i,this.v,this.B,this.l,this.S,c,e),this.o){if(this.U&&!this.L){e:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(r)){var o=r;break e}}o=null}if(!(t=o)){this.o=!1,this.m=3,wt(12),Ht(this),Bt(this);break t}bt(this.i,this.l,t,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qt(this,t)}if(this.R){let e;for(t=!0;!this.K&&this.C<n.length;){if(e=Vt(this,n),e==Dt){4==c&&(this.m=4,wt(14),t=!1),bt(this.i,this.l,null,"[Incomplete Response]");break}if(e==Pt){this.m=4,wt(15),bt(this.i,this.l,n,"[Invalid Chunk]"),t=!1;break}bt(this.i,this.l,e,null),qt(this,e)}if(xt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=c||0!=n.length||this.h.h||(this.m=1,wt(16),t=!1),this.o=this.o&&t,t){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ye(a),a.P=!0,wt(11))}}else bt(this.i,this.l,n,"[Invalid Chunked Response]"),Ht(this),Bt(this)}else bt(this.i,this.l,n,null),qt(this,n);4==c&&Ht(this),this.o&&!this.K&&(4==c?tn(this.j,this):(this.o=!1,Ut(this)))}else(function(t){const e={};t=(t.g&&Ue(t)>=2&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(A(t[r]))continue;var n=Rt(t[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(t){return t.join(", ")})})(this.g),400==e&&n.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),Ht(this),Bt(this)}}}catch(c){}},Nt.prototype.cancel=function(){this.K=!0,Ht(this)},Nt.prototype.aa=function(){this.D=null;const t=Date.now();t-this.T>=0?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.B),2!=this.M&&(yt(),wt(17)),Ht(this),this.m=2,Bt(this)):Ft(this,this.T-t)};var Wt=class{constructor(t,e){this.g=t,this.map=e}};function zt(t){this.l=t||10,s.PerformanceNavigationTiming?t=(t=s.performance.getEntriesByType("navigation")).length>0&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Kt(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Gt(t){return t.h?1:t.g?t.g.size:0}function Jt(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Xt(t,e){t.g?t.g.add(e):t.h=e}function Qt(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Yt(t){if(null!=t.h)return t.i.concat(t.h.G);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.G);return e}return d(t.i)}zt.prototype.cancel=function(){if(this.i=Yt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var $t=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Zt(t){let e;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,t instanceof Zt?(this.l=t.l,ee(this,t.j),this.o=t.o,this.g=t.g,ne(this,t.u),this.h=t.h,re(this,_e(t.i)),this.m=t.m):t&&(e=String(t).match($t))?(this.l=!1,ee(this,e[1]||"",!0),this.o=oe(e[2]||""),this.g=oe(e[3]||"",!0),ne(this,e[4]),this.h=oe(e[5]||"",!0),re(this,e[6]||"",!0),this.m=oe(e[7]||"")):(this.l=!1,this.i=new pe(null,this.l))}function te(t){return new Zt(t)}function ee(t,e,n){t.j=n?oe(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ne(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.u=e}else t.u=null}function re(t,e,n){e instanceof pe?(t.i=e,function(t,e){e&&!t.j&&(ge(t),t.i=null,t.g.forEach(function(t,e){const n=e.toLowerCase();e!=n&&(me(this,e),we(this,n,t))},t)),t.j=e}(t.i,t.l)):(n||(e=ae(e,de)),t.i=new pe(e,t.l))}function ie(t,e,n){t.i.set(e,n)}function se(t){return ie(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function oe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ae(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,ce),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ce(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Zt.prototype.toString=function(){const t=[];var e=this.j;e&&t.push(ae(e,le,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(ae(e,le,!0),"@"),t.push(kt(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&t.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ae(n,"/"==n.charAt(0)?he:ue,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",ae(n,fe)),t.join("")},Zt.prototype.resolve=function(t){const e=te(this);let n=!!t.j;n?ee(e,t.j):n=!!t.o,n?e.o=t.o:n=!!t.g,n?e.g=t.g:n=null!=t.u;var r=t.h;if(n)ne(e,t.u);else if(n=!!t.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=e.h.lastIndexOf("/");-1!=i&&(r=e.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const t=[];for(let e=0;e<i.length;){const n=i[e++];"."==n?r&&e==i.length&&t.push(""):".."==n?((t.length>1||1==t.length&&""!=t[0])&&t.pop(),r&&e==i.length&&t.push("")):(t.push(n),r=!0)}r=t.join("/")}else r=i}return n?e.h=r:n=""!==t.i.toString(),n?re(e,_e(t.i)):n=!!t.m,n&&(e.m=t.m),e};var le=/[#\/\?@]/g,ue=/[#\?:]/g,he=/[#\?]/g,de=/[#\?@]/g,fe=/#/g;function pe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ge(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(let n=0;n<t.length;n++){const r=t[n].indexOf("=");let i,s=null;r>=0?(i=t[n].substring(0,r),s=t[n].substring(r+1)):i=t[n],e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function me(t,e){ge(t),e=Ee(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ye(t,e){return ge(t),e=Ee(t,e),t.g.has(e)}function ve(t,e){ge(t);let n=[];if("string"===typeof e)ye(t,e)&&(n=n.concat(t.g.get(Ee(t,e))));else for(t=Array.from(t.g.values()),e=0;e<t.length;e++)n=n.concat(t[e]);return n}function we(t,e,n){me(t,e),n.length>0&&(t.i=null,t.g.set(Ee(t,e),d(n)),t.h+=n.length)}function _e(t){const e=new pe;return e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),e}function Ee(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ie(t,e,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function be(){this.g=new at}function Te(t){this.i=t.Sb||null,this.h=t.ab||!1}function Se(t,e){Y.call(this),this.H=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ae(t){t.j.read().then(t.Ma.bind(t)).catch(t.ga.bind(t))}function Ce(t){t.readyState=4,t.l=null,t.j=null,t.B=null,ke(t)}function ke(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Re(t){let e="";return P(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function Ne(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Re(n),"string"===typeof t?null!=n&&kt(n):ie(t,e,n))}function Oe(t){Y.call(this),this.headers=new Map,this.L=t||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=pe.prototype).add=function(t,e){ge(this),this.i=null,t=Ee(this,t);let n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){ge(this),this.g.forEach(function(n,r){n.forEach(function(n){t.call(e,n,r,this)},this)},this)},t.set=function(t,e){return ge(this),this.i=null,ye(this,t=Ee(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&(t=ve(this,t)).length>0?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(let r=0;r<e.length;r++){var n=e[r];const i=kt(n);n=ve(this,n);for(let e=0;e<n.length;e++){let r=i;""!==n[e]&&(r+="="+kt(n[e])),t.push(r)}}return this.i=t.join("&")},u(Te,ct),Te.prototype.g=function(){return new Se(this.i,this.h)},u(Se,Y),(t=Se.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=t,this.D=e,this.readyState=1,ke(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const e={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};t&&(e.body=t),(this.H||s).fetch(new Request(this.D,e)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ce(this)),this.readyState=0},t.Pa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ke(this)),this.g&&(this.readyState=3,ke(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ae(this)}else t.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.B.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ce(this):ke(this),3==this.readyState&&Ae(this)}},t.Oa=function(t){this.g&&(this.response=this.responseText=t,Ce(this))},t.Na=function(t){this.g&&(this.response=t,Ce(this))},t.ga=function(){this.g&&Ce(this)},t.setRequestHeader=function(t,e){this.A.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Se.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),u(Oe,Y);var Pe=/^https?$/i,De=["POST","PUT"];function Le(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.o=5,Me(t),Ve(t)}function Me(t){t.A||(t.A=!0,$(t,"complete"),$(t,"error"))}function xe(t){if(t.h&&"undefined"!=typeof i)if(t.v&&4==Ue(t))setTimeout(t.Ca.bind(t),0);else if($(t,"readystatechange"),4==Ue(t)){t.h=!1;try{const i=t.ca();t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===i){let e=String(t.D).match($t)[1]||null;!e&&s.self&&s.self.location&&(e=s.self.location.protocol.slice(0,-1)),r=!Pe.test(e?e.toLowerCase():"")}n=r}if(n)$(t,"complete"),$(t,"success");else{t.o=6;try{var o=Ue(t)>2?t.g.statusText:""}catch(a){o=""}t.l=o+" ["+t.ca()+"]",Me(t)}}finally{Ve(t)}}}function Ve(t,e){if(t.g){t.m&&(clearTimeout(t.m),t.m=null);const r=t.g;t.g=null,e||$(t,"ready");try{r.onreadystatechange=null}catch(n){}}}function Ue(t){return t.g?t.g.readyState:0}function Fe(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.F){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function je(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Be(t){this.za=0,this.i=[],this.j=new It,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=je("failFast",!1,t),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=je("baseRetryDelayMs",5e3,t),this.Za=je("retryDelaySeedMs",1e4,t),this.Ta=je("forwardChannelMaxRetries",2,t),this.va=je("forwardChannelRequestTimeoutMs",2e4,t),this.ma=t&&t.xmlHttpFactory||void 0,this.Ua=t&&t.Rb||void 0,this.Aa=t&&t.useFetchStreams||!1,this.O=void 0,this.L=t&&t.supportsCrossDomainXhr||!1,this.M="",this.h=new zt(t&&t.concurrentRequestLimit),this.Ba=new be,this.S=t&&t.fastHandshake||!1,this.R=t&&t.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=t&&t.Pb||!1,t&&t.ua&&this.j.ua(),t&&t.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&t&&t.detectBufferingProxy||!1,this.ia=void 0,t&&t.longPollingTimeout&&t.longPollingTimeout>0&&(this.ia=t.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function He(t){if(We(t),3==t.I){var e=t.V++,n=te(t.J);if(ie(n,"SID",t.M),ie(n,"RID",e),ie(n,"TYPE","terminate"),Ge(t,n),(e=new Nt(t,t.j,e)).M=2,e.A=se(te(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(e.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=e.A,n=!0),n||(e.g=on(e.j,null),e.g.ea(e.A)),e.F=Date.now(),Ut(e)}rn(t)}function qe(t){t.g&&(Ye(t),t.g.cancel(),t.g=null)}function We(t){qe(t),t.v&&(s.clearTimeout(t.v),t.v=null),Ze(t),t.h.cancel(),t.m&&("number"===typeof t.m&&s.clearTimeout(t.m),t.m=null)}function ze(t){if(!Kt(t.h)&&!t.m){t.m=!0;var e=t.Ea;v||E(),w||(v(),w=!0),_.add(e,t),t.D=0}}function Ke(t,e){var n;n=e?e.l:t.V++;const r=te(t.J);ie(r,"SID",t.M),ie(r,"RID",n),ie(r,"AID",t.K),Ge(t,r),t.u&&t.o&&Ne(r,t.u,t.o),n=new Nt(t,t.j,n,t.D+1),null===t.u&&(n.J=t.o),e&&(t.i=e.G.concat(t.i)),e=Je(t,n,1e3),n.H=Math.round(.5*t.va)+Math.round(.5*t.va*Math.random()),Xt(t.h,n),Lt(n,r,e)}function Ge(t,e){t.H&&P(t.H,function(t,n){ie(e,n,t)}),t.l&&P({},function(t,n){ie(e,n,t)})}function Je(t,e,n){n=Math.min(t.i.length,n);const r=t.l?c(t.l.Ka,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?n>0?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let c=!0;for(let l=0;l<n;l++){var s=i[l].g;const n=i[l].map;if((s-=e)<0)e=Math.max(0,i[l].g-100),c=!1;else try{s="req"+s+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[e,n]of a){let r=n;o(n)&&(r=st(n)),t.push(s+e+"="+encodeURIComponent(r))}}catch(ks){throw t.push(s+"type="+encodeURIComponent("_badmap")),ks}}catch(ks){r&&r(n)}}if(c){a=t.join("&");break t}}a=void 0}return t=t.i.splice(0,n),e.G=t,a}function Xe(t){if(!t.g&&!t.v){t.Y=1;var e=t.Da;v||E(),w||(v(),w=!0),_.add(e,t),t.A=0}}function Qe(t){return!(t.g||t.v||t.A>=3)&&(t.Y++,t.v=Et(c(t.Da,t),en(t,t.A)),t.A++,!0)}function Ye(t){null!=t.B&&(s.clearTimeout(t.B),t.B=null)}function $e(t){t.g=new Nt(t,t.j,"rpc",t.Y),null===t.u&&(t.g.J=t.o),t.g.P=0;var e=te(t.na);ie(e,"RID","rpc"),ie(e,"SID",t.M),ie(e,"AID",t.K),ie(e,"CI",t.F?"0":"1"),!t.F&&t.ia&&ie(e,"TO",t.ia),ie(e,"TYPE","xmlhttp"),Ge(t,e),t.u&&t.o&&Ne(e,t.u,t.o),t.O&&(t.g.H=t.O);var n=t.g;t=t.ba,n.M=1,n.A=se(te(e)),n.u=null,n.R=!0,Mt(n,t)}function Ze(t){null!=t.C&&(s.clearTimeout(t.C),t.C=null)}function tn(t,e){var n=null;if(t.g==e){Ze(t),Ye(t),t.g=null;var r=2}else{if(!Jt(t.h,e))return;n=e.G,Qt(t.h,e),r=1}if(0!=t.I)if(e.o)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.F;var i=t.D;$(r=gt(),new _t(r,n)),ze(t)}else Xe(t);else if(3==(i=e.m)||0==i&&e.X>0||!(1==r&&function(t,e){return!(Gt(t.h)>=t.h.j-(t.m?1:0))&&(t.m?(t.i=e.G.concat(t.i),!0):!(1==t.I||2==t.I||t.D>=(t.Sa?0:t.Ta))&&(t.m=Et(c(t.Ea,t,e),en(t,t.D)),t.D++,!0))}(t,e)||2==r&&Qe(t)))switch(n&&n.length>0&&(e=t.h,e.i=e.i.concat(n)),i){case 1:nn(t,5);break;case 4:nn(t,10);break;case 3:nn(t,6);break;default:nn(t,2)}}function en(t,e){let n=t.Qa+Math.floor(Math.random()*t.Za);return t.isActive()||(n*=2),n*e}function nn(t,e){if(t.j.info("Error code "+e),2==e){var n=c(t.bb,t),r=t.Ua;const e=!r;r=new Zt(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ee(r,"https"),se(r),e?function(t,e){const n=new It;if(s.Image){const r=new Image;r.onload=l(Ie,n,"TestLoadImage: loaded",!0,e,r),r.onerror=l(Ie,n,"TestLoadImage: error",!1,e,r),r.onabort=l(Ie,n,"TestLoadImage: abort",!1,e,r),r.ontimeout=l(Ie,n,"TestLoadImage: timeout",!1,e,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(r.toString(),n):function(t,e){new It;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ie(0,0,!1,e)},1e4);fetch(t,{signal:n.signal}).then(t=>{clearTimeout(r),t.ok?Ie(0,0,!0,e):Ie(0,0,!1,e)}).catch(()=>{clearTimeout(r),Ie(0,0,!1,e)})}(r.toString(),n)}else wt(2);t.I=0,t.l&&t.l.pa(e),rn(t),We(t)}function rn(t){if(t.I=0,t.ja=[],t.l){const e=Yt(t.h);0==e.length&&0==t.i.length||(f(t.ja,e),f(t.ja,t.i),t.h.i.length=0,d(t.i),t.i.length=0),t.l.oa()}}function sn(t,e,n){var r=n instanceof Zt?te(n):new Zt(n);if(""!=r.g)e&&(r.g=e+"."+r.g),ne(r,r.u);else{var i=s.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;const t=new Zt(null);r&&ee(t,r),e&&(t.g=e),i&&ne(t,i),n&&(t.h=n),r=t}return n=t.G,e=t.wa,n&&e&&ie(r,n,e),ie(r,"VER",t.ka),Ge(t,r),r}function on(t,e,n){if(e&&!t.L)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Aa&&!t.ma?new Oe(new Te({ab:n})):new Oe(t.ma)).Fa(t.L),e}function an(){}function cn(){}function ln(t,e){Y.call(this),this.g=new Be(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.sa&&(t?t["X-WebChannel-Client-Profile"]=e.sa:t={"X-WebChannel-Client-Profile":e.sa}),this.g.U=t,(t=e&&e.Qb)&&!A(t)&&(this.g.u=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.g.G=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new dn(this)}function un(t){ht.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function hn(){dt.call(this),this.status=1}function dn(t){this.g=t}(t=Oe.prototype).Fa=function(t){this.H=t},t.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Tt.g(),this.g.onreadystatechange=h(c(this.Ca,this));try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(o){return void Le(this,o)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),i=s.FormData&&t instanceof s.FormData,!(Array.prototype.indexOf.call(De,e,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(t),this.v=!1}catch(o){Le(this,o)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=t||7,$(this,"complete"),$(this,"abort"),Ve(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ve(this,!0)),Oe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?xe(this):this.Xa())},t.Xa=function(){xe(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return Ue(this)>2?this.g.status:-1}catch(t){return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},t.La=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ot(e)}},t.ya=function(){return this.o},t.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=Be.prototype).ka=8,t.I=1,t.connect=function(t,e,n,r){wt(0),this.W=t,this.H=e||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=sn(this,null,this.W),ze(this)},t.Ea=function(t){if(this.m)if(this.m=null,1==this.I){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const i=new Nt(this,this.j,t);let s=this.o;if(this.U&&(s?(s=D(s),M(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((e+=r)>4096){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Je(this,i,e),ie(n=te(this.J),"RID",t),ie(n,"CVER",22),this.G&&ie(n,"X-HTTP-Session-Id",this.G),Ge(this,n),s&&(this.R?e="headers="+kt(Re(s))+"&"+e:this.u&&Ne(n,this.u,s)),Xt(this.h,i),this.Ra&&ie(n,"TYPE","init"),this.S?(ie(n,"$req",e),ie(n,"SID","null"),i.U=!0,Lt(i,n,null)):Lt(i,n,e),this.I=2}}else 3==this.I&&(t?Ke(this,t):0==this.i.length||Kt(this.h)||Ke(this))},t.Da=function(){if(this.v=null,$e(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var t=4*this.T;this.j.info("BP detection timer enabled: "+t),this.B=Et(c(this.Wa,this),t)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),qe(this),$e(this))},t.Va=function(){null!=this.C&&(this.C=null,qe(this),Qe(this),wt(19))},t.bb=function(t){t?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=an.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},cn.prototype.g=function(t,e){return new ln(t,e)},u(ln,Y),ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){He(this.g)},ln.prototype.o=function(t){var e=this.g;if("string"===typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=st(t),t=n);e.i.push(new Wt(e.Ya++,t)),3==e.I&&ze(e)},ln.prototype.N=function(){this.g.l=null,delete this.j,He(this.g),delete this.g,ln.Z.N.call(this)},u(un,ht),u(hn,dt),u(dn,an),dn.prototype.ra=function(){$(this.g,"a")},dn.prototype.qa=function(t){$(this.g,new un(t))},dn.prototype.pa=function(t){$(this.g,new hn)},dn.prototype.oa=function(){$(this.g,"b")},cn.prototype.createWebChannel=cn.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,Ji=Qi.createWebChannelTransport=function(){return new cn},Gi=Qi.getStatEventTarget=function(){return gt()},Ki=Qi.Event=ft,zi=Qi.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},St.NO_ERROR=0,St.TIMEOUT=8,St.HTTP_ERROR=6,Wi=Qi.ErrorCode=St,At.COMPLETE="complete",qi=Qi.EventType=At,lt.EventType=ut,ut.OPEN="a",ut.CLOSE="b",ut.ERROR="c",ut.MESSAGE="d",Y.prototype.listen=Y.prototype.J,Hi=Qi.WebChannel=lt,Qi.FetchXmlHttpFactory=Te,Oe.prototype.listenOnce=Oe.prototype.K,Oe.prototype.getLastError=Oe.prototype.Ha,Oe.prototype.getLastErrorCode=Oe.prototype.ya,Oe.prototype.getStatus=Oe.prototype.ca,Oe.prototype.getResponseJson=Oe.prototype.La,Oe.prototype.getResponseText=Oe.prototype.la,Oe.prototype.send=Oe.prototype.ea,Oe.prototype.setWithCredentials=Oe.prototype.Fa,Bi=Qi.XhrIo=Oe}).apply("undefined"!==typeof Xi?Xi:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});class Yi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Yi.UNAUTHENTICATED=new Yi(null),Yi.GOOGLE_CREDENTIALS=new Yi("google-credentials-uid"),Yi.FIRST_PARTY=new Yi("first-party-uid"),Yi.MOCK_USER=new Yi("mock-user");let $i="12.9.0";const Zi=new X("@firebase/firestore");function ts(){return Zi.logLevel}function es(t){if(Zi.logLevel<=W.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(is);Zi.debug("Firestore (".concat($i,"): ").concat(t),...i)}}function ns(t){if(Zi.logLevel<=W.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(is);Zi.error("Firestore (".concat($i,"): ").concat(t),...i)}}function rs(t){if(Zi.logLevel<=W.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(is);Zi.warn("Firestore (".concat($i,"): ").concat(t),...i)}}function is(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function ss(t,e,n){let r="Unexpected state";"string"==typeof e?r=e:n=e,os(t,r,n)}function os(t,e,n){let r="FIRESTORE (".concat($i,") INTERNAL ASSERTION FAILED: ").concat(e," (ID: ").concat(t.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(t){r+=" CONTEXT: "+n}throw ns(r),new Error(r)}function as(t,e,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,t||os(e,i,r)}function cs(t,e){return t}const ls={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class us extends k{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class hs{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class ds{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class fs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Yi.UNAUTHENTICATED))}shutdown(){}}class ps{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class gs{constructor(t){this.t=t,this.currentUser=Yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){as(void 0===this.o,42304);let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new hs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new hs,t.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const e=i;t.enqueueRetryable(async()=>{await e.promise,await r(this.currentUser)})},o=t=>{es("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(t=>o(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(es("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new hs)}},0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(es("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(as("string"==typeof e.accessToken,31837,{l:e}),new ds(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return as(null===t||"string"==typeof t,2055,{h:t}),new Yi(t)}}class ms{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=Yi.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class ys{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new ms(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(Yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vs{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ws{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qt(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){as(void 0===this.o,3512);const n=t=>{null!=t.error&&es("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const n=t.token!==this.m;return this.m=t.token,es("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const r=t=>{es("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(t=>r(t)),setTimeout(()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?r(t):es("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new vs(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(as("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new vs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function _s(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class Es{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=_s(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function Is(t,e){return t<e?-1:t>e?1:0}function bs(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.charAt(r),i=e.charAt(r);if(n!==i)return As(n)===As(i)?Is(n,i):As(n)?1:-1}return Is(t.length,e.length)}const Ts=55296,Ss=57343;function As(t){const e=t.charCodeAt(0);return e>=Ts&&e<=Ss}function Cs(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}const ks="__name__";class Rs{constructor(t,e,n){void 0===e?e=0:e>t.length&&ss(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&ss(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Rs.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Rs?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=Rs.compareSegments(t.get(r),e.get(r));if(0!==n)return n}return Is(t.length,e.length)}static compareSegments(t,e){const n=Rs.isNumericId(t),r=Rs.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?Rs.extractNumericId(t).compare(Rs.extractNumericId(e)):bs(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ui.fromString(t.substring(4,t.length-2))}}class Ns extends Rs{construct(t,e,n){return new Ns(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new us(ls.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));t.push(...i.split("/").filter(t=>t.length>0))}return new Ns(t)}static emptyPath(){return new Ns([])}}const Os=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ps extends Rs{construct(t,e,n){return new Ps(t,e,n)}static isValidIdentifier(t){return Os.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ps.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===ks}static keyField(){return new Ps([ks])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new us(ls.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new us(ls.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new us(ls.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new us(ls.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ps(e)}static emptyPath(){return new Ps([])}}class Ds{constructor(t){this.path=t}static fromPath(t){return new Ds(Ns.fromString(t))}static fromName(t){return new Ds(Ns.fromString(t).popFirst(5))}static empty(){return new Ds(Ns.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ns.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ns.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ds(new Ns(t.slice()))}}function Ls(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ms(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":ss(12329,{type:typeof t})}function xs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new us(ls.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ms(t);throw new us(ls.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}}return t}function Vs(t,e){const n={typeString:t};return e&&(n.value=e),n}function Us(t,e){if(!Ls(t))throw new us(ls.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n="JSON missing required field: '".concat(r,"'");break}const o=t[r];if(i&&typeof o!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==s&&o!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new us(ls.INVALID_ARGUMENT,n);return!0}const Fs=-62135596800,js=1e6;class Bs{static now(){return Bs.fromMillis(Date.now())}static fromDate(t){return Bs.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*js);return new Bs(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new us(ls.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new us(ls.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Fs)throw new us(ls.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new us(ls.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/js}_compareTo(t){return this.seconds===t.seconds?Is(this.nanoseconds,t.nanoseconds):Is(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bs._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Us(t,Bs._jsonSchema))return new Bs(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Fs;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bs._jsonSchemaVersion="firestore/timestamp/1.0",Bs._jsonSchema={type:Vs("string",Bs._jsonSchemaVersion),seconds:Vs("number"),nanoseconds:Vs("number")};class Hs{static fromTimestamp(t){return new Hs(t)}static min(){return new Hs(new Bs(0,0))}static max(){return new Hs(new Bs(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qs=-1;class Ws{constructor(t,e,n,r){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=r}}Ws.UNKNOWN_ID=-1;function zs(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Hs.fromTimestamp(1e9===r?new Bs(n+1,0):new Bs(n,r));return new Gs(i,Ds.empty(),e)}function Ks(t){return new Gs(t.readTime,t.key,qs)}class Gs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Gs(Hs.min(),Ds.empty(),qs)}static max(){return new Gs(Hs.max(),Ds.empty(),qs)}}function Js(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ds.comparator(t.documentKey,e.documentKey),0!==n?n:Is(t.largestBatchId,e.largestBatchId))}class Xs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}class Qs{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ss(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Qs((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Qs?e:Qs.resolve(e)}catch(t){return Qs.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Qs.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Qs.reject(e)}static resolve(t){return new Qs((e,n)=>{e(t)})}static reject(t){return new Qs((e,n)=>{n(t)})}static waitFor(t){return new Qs((e,n)=>{let r=0,i=0,s=!1;t.forEach(t=>{++r,t.next(()=>{++i,s&&i===r&&e()},t=>n(t))}),s=!0,i===r&&e()})}static or(t){let e=Qs.resolve(!1);for(const n of t)e=e.next(t=>t?Qs.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.waitFor(n)}static mapArray(t,e){return new Qs((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next(t=>{s[c]=t,++o,o===i&&n(s)},t=>r(t))}})}static doWhile(t,e){return new Qs((n,r)=>{const i=()=>{!0===t()?e().next(()=>{i()},r):n()};i()})}}function Ys(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $s(t){return"IndexedDbTransactionError"===t.name}class Zs{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ae(t),this.ue=t=>e.writeSequenceNumber(t))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Zs.ce=-1;const to=-1;function eo(t){return null==t}function no(t){return 0===t&&1/t==-1/0}const ro="remoteDocuments",io="owner",so="mutationQueues",oo="mutations";const ao="documentMutations",co="remoteDocumentsV14",lo="remoteDocumentGlobal",uo="targets",ho="targetDocuments",fo="targetGlobal",po="collectionParents",go="clientMetadata",mo="bundles",yo="namedQueries",vo="indexConfiguration",wo="indexState",_o="indexEntries",Eo="documentOverlays",Io="globals",bo=[so,oo,ao,ro,uo,io,fo,ho,go,lo,po,mo,yo],To=[so,oo,ao,co,uo,io,fo,ho,go,lo,po,mo,yo,Eo],So=To,Ao=[...So,vo,wo,_o];function Co(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ko(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ro(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class No{constructor(t,e){this.comparator=t,this.root=e||Po.EMPTY}insert(t,e){return new No(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Po.BLACK,null,null))}remove(t){return new No(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Po.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push("".concat(e,":").concat(n)),!1)),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Oo(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Oo(this.root,t,this.comparator,!1)}getReverseIterator(){return new Oo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Oo(this.root,t,this.comparator,!0)}}class Oo{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Po{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Po.RED,this.left=null!=r?r:Po.EMPTY,this.right=null!=i?i:Po.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new Po(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Po.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return Po.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Po.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Po.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ss(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ss(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw ss(27949);return t+(this.isRed()?0:1)}}Po.EMPTY=null,Po.RED=!0,Po.BLACK=!1,Po.EMPTY=new class{constructor(){this.size=0}get key(){throw ss(57766)}get value(){throw ss(16141)}get color(){throw ss(16727)}get left(){throw ss(29726)}get right(){throw ss(36894)}copy(t,e,n,r,i){return this}insert(t,e,n){return new Po(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Do{constructor(t){this.comparator=t,this.data=new No(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Lo(this.data.getIterator())}getIteratorFrom(t){return new Lo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof Do))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Do(this.comparator);return e.data=t,e}}class Lo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Mo{constructor(t){this.fields=t,t.sort(Ps.comparator)}static empty(){return new Mo([])}unionWith(t){let e=new Do(Ps.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new Mo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Cs(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class xo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Vo{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new xo("Invalid base64 string: "+t):t}}(t);return new Vo(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Vo(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Is(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Vo.EMPTY_BYTE_STRING=new Vo("");const Uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fo(t){if(as(!!t,39018),"string"==typeof t){let e=0;const n=Uo.exec(t);if(as(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:jo(t.seconds),nanos:jo(t.nanos)}}function jo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?Vo.fromBase64String(t):Vo.fromUint8Array(t)}const Ho="server_timestamp",qo="__type__",Wo="__previous_value__",zo="__local_write_time__";function Ko(t){var e,n;return(null===(e=((null===t||void 0===t||null===(n=t.mapValue)||void 0===n?void 0:n.fields)||{})[qo])||void 0===e?void 0:e.stringValue)===Ho}function Go(t){const e=t.mapValue.fields[Wo];return Ko(e)?Go(e):e}function Jo(t){const e=Fo(t.mapValue.fields[zo].timestampValue);return new Bs(e.seconds,e.nanos)}const Xo="(default)";class Qo{constructor(t,e){this.projectId=t,this.database=e||Xo}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===Xo}isEqual(t){return t instanceof Qo&&t.projectId===this.projectId&&t.database===this.database}}const Yo="__type__",$o="__max__",Zo={mapValue:{fields:{__type__:{stringValue:$o}}}},ta="__vector__",ea="value";function na(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ko(t)?4:ga(t)?9007199254740991:fa(t)?10:11:ss(28295,{value:t})}function ra(t,e){if(t===e)return!0;const n=na(t);if(n!==na(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jo(t).isEqual(Jo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Fo(t.timestampValue),r=Fo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bo(t.bytesValue).isEqual(Bo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return jo(t.geoPointValue.latitude)===jo(e.geoPointValue.latitude)&&jo(t.geoPointValue.longitude)===jo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return jo(t.integerValue)===jo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=jo(t.doubleValue),r=jo(e.doubleValue);return n===r?no(n)===no(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Cs(t.arrayValue.values||[],e.arrayValue.values||[],ra);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Co(n)!==Co(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ra(n[i],r[i])))return!1;return!0}(t,e);default:return ss(52216,{left:t})}}function ia(t,e){return void 0!==(t.values||[]).find(t=>ra(t,e))}function sa(t,e){if(t===e)return 0;const n=na(t),r=na(e);if(n!==r)return Is(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Is(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=jo(t.integerValue||t.doubleValue),r=jo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return oa(t.timestampValue,e.timestampValue);case 4:return oa(Jo(t),Jo(e));case 5:return bs(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Bo(t),r=Bo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let i=0;i<n.length&&i<r.length;i++){const t=Is(n[i],r[i]);if(0!==t)return t}return Is(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Is(jo(t.latitude),jo(e.latitude));return 0!==n?n:Is(jo(t.longitude),jo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return aa(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,r,i,s;const o=t.fields||{},a=e.fields||{},c=null===(n=o[ea])||void 0===n?void 0:n.arrayValue,l=null===(r=a[ea])||void 0===r?void 0:r.arrayValue,u=Is((null===c||void 0===c||null===(i=c.values)||void 0===i?void 0:i.length)||0,(null===l||void 0===l||null===(s=l.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:aa(c,l)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===Zo.mapValue&&e===Zo.mapValue)return 0;if(t===Zo.mapValue)return 1;if(e===Zo.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const t=bs(r[o],s[o]);if(0!==t)return t;const e=sa(n[r[o]],i[s[o]]);if(0!==e)return e}return Is(r.length,s.length)}(t.mapValue,e.mapValue);default:throw ss(23264,{he:n})}}function oa(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Is(t,e);const n=Fo(t),r=Fo(e),i=Is(n.seconds,r.seconds);return 0!==i?i:Is(n.nanos,r.nanos)}function aa(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const t=sa(n[i],r[i]);if(t)return t}return Is(n.length,r.length)}function ca(t){return la(t)}function la(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Fo(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Bo(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Ds.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return"geo(".concat(t.latitude,",").concat(t.longitude,")")}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=la(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+="".concat(i,":").concat(la(t.fields[i]));return n+"}"}(t.mapValue):ss(61005,{value:t})}function ua(t){return!!t&&"integerValue"in t}function ha(t){return!!t&&"arrayValue"in t}function da(t){return!!t&&"mapValue"in t}function fa(t){var e,n;return(null===(e=((null===t||void 0===t||null===(n=t.mapValue)||void 0===n?void 0:n.fields)||{})[Yo])||void 0===e?void 0:e.stringValue)===ta}function pa(t){if(t.geoPointValue)return{geoPointValue:a({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:a({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ko(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=pa(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=pa(t.arrayValue.values[n]);return e}return a({},t)}function ga(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===$o}class ma{constructor(t){this.value=t}static empty(){return new ma({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!da(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=pa(e)}setAll(t){let e=Ps.emptyPath(),n={},r=[];t.forEach((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=pa(t):r.push(i.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());da(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ra(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];da(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){ko(e,(e,n)=>t[e]=n);for(const r of n)delete t[r]}clone(){return new ma(pa(this.value))}}class ya{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new ya(t,0,Hs.min(),Hs.min(),Hs.min(),ma.empty(),0)}static newFoundDocument(t,e,n,r){return new ya(t,1,e,Hs.min(),n,r,0)}static newNoDocument(t,e){return new ya(t,2,e,Hs.min(),Hs.min(),ma.empty(),0)}static newUnknownDocument(t,e){return new ya(t,3,e,Hs.min(),Hs.min(),ma.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Hs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ma.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ma.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Hs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof ya&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ya(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class va{constructor(t,e){this.position=t,this.inclusive=e}}function wa(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?Ds.comparator(Ds.fromName(o.referenceValue),n.key):sa(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function _a(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ra(t.position[n],e.position[n]))return!1;return!0}class Ea{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function Ia(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ba{}class Ta extends ba{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Pa(t,e,n):"array-contains"===e?new xa(t,n):"in"===e?new Va(t,n):"not-in"===e?new Ua(t,n):"array-contains-any"===e?new Fa(t,n):new Ta(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Da(t,n):new La(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(sa(e,this.value)):null!==e&&na(this.value)===na(e)&&this.matchesComparison(sa(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ss(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sa extends ba{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Sa(t,e)}matches(t){return Aa(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Aa(t){return"and"===t.op}function Ca(t){return ka(t)&&Aa(t)}function ka(t){for(const e of t.filters)if(e instanceof Sa)return!1;return!0}function Ra(t){if(t instanceof Ta)return t.field.canonicalString()+t.op.toString()+ca(t.value);if(Ca(t))return t.filters.map(t=>Ra(t)).join(",");{const e=t.filters.map(t=>Ra(t)).join(",");return"".concat(t.op,"(").concat(e,")")}}function Na(t,e){return t instanceof Ta?function(t,e){return e instanceof Ta&&t.op===e.op&&t.field.isEqual(e.field)&&ra(t.value,e.value)}(t,e):t instanceof Sa?function(t,e){return e instanceof Sa&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,r)=>t&&Na(n,e.filters[r]),!0)}(t,e):void ss(19439)}function Oa(t){return t instanceof Ta?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(ca(t.value))}(t):t instanceof Sa?function(t){return t.op.toString()+" {"+t.getFilters().map(Oa).join(" ,")+"}"}(t):"Filter"}class Pa extends Ta{constructor(t,e,n){super(t,e,n),this.key=Ds.fromName(n.referenceValue)}matches(t){const e=Ds.comparator(t.key,this.key);return this.matchesComparison(e)}}class Da extends Ta{constructor(t,e){super(t,"in",e),this.keys=Ma("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class La extends Ta{constructor(t,e){super(t,"not-in",e),this.keys=Ma("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ma(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>Ds.fromName(t.referenceValue))}class xa extends Ta{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ha(e)&&ia(e.arrayValue,this.value)}}class Va extends Ta{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&ia(this.value.arrayValue,e)}}class Ua extends Ta{constructor(t,e){super(t,"not-in",e)}matches(t){if(ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!ia(this.value.arrayValue,e)}}class Fa extends Ta{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ha(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>ia(this.value.arrayValue,t))}}class ja{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function Ba(t){return new ja(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ha(t){const e=cs(t);if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>Ra(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),eo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>ca(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>ca(t)).join(",")),e.Te=t}return e.Te}function qa(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ia(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Na(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!_a(t.startAt,e.startAt)&&_a(t.endAt,e.endAt)}class Wa{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function za(t,e,n,r,i,s,o,a){return new Wa(t,e,n,r,i,s,o,a)}function Ka(t){return new Wa(t)}function Ga(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Ja(t){return null!==t.collectionGroup}function Xa(t){const e=cs(t);if(null===e.Ie){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new Do(Ps.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e}(e);r.forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new Ea(r,n))}),t.has(Ps.keyField().canonicalString())||e.Ie.push(new Ea(Ps.keyField(),n))}return e.Ie}function Qa(t){const e=cs(t);return e.Ee||(e.Ee=Ya(e,Xa(t))),e.Ee}function Ya(t,e){if("F"===t.limitType)return Ba(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new Ea(t.field,e)});const n=t.endAt?new va(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new va(t.startAt.position,t.startAt.inclusive):null;return Ba(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $a(t,e,n){return new Wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Za(t,e){return qa(Qa(t),Qa(e))&&t.limitType===e.limitType}function tc(t){return"".concat(Ha(Qa(t)),"|lt:").concat(t.limitType)}function ec(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map(t=>Oa(t)).join(", "),"]")),eo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map(t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t)).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>ca(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>ca(t)).join(",")),"Target(".concat(e,")")}(Qa(t)),"; limitType=").concat(t.limitType,")")}function nc(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ds.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Xa(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=wa(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,Xa(t),e))&&!(t.endAt&&!function(t,e,n){const r=wa(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,Xa(t),e))}(t,e)}function rc(t){return(e,n)=>{let r=!1;for(const i of Xa(t)){const t=ic(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}function ic(t,e,n){const r=t.field.isKeyField()?Ds.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?sa(r,i):ss(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ss(19790,{direction:t.dir})}}class sc{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){ko(this.inner,(e,n)=>{for(const[r,i]of n)t(r,i)})}isEmpty(){return Ro(this.inner)}size(){return this.innerSize}}const oc=new No(Ds.comparator);function ac(){return oc}const cc=new No(Ds.comparator);function lc(){let t=cc;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)t=t.insert(i.key,i);return t}function uc(t){let e=cc;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function hc(){return fc()}function dc(){return fc()}function fc(){return new sc(t=>t.toString(),(t,e)=>t.isEqual(e))}new No(Ds.comparator);const pc=new Do(Ds.comparator);function gc(){let t=pc;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)t=t.add(i);return t}const mc=new Do(Is);function yc(){return mc}function vc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:no(e)?"-0":e}}function wc(t){return{integerValue:""+t}}class _c{constructor(){this._=void 0}}function Ec(t,e,n){return t instanceof Tc?function(t,e){const n={fields:{[qo]:{stringValue:Ho},[zo]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Ko(e)&&(e=Go(e)),e&&(n.fields[Wo]=e),{mapValue:n}}(n,e):t instanceof Sc?Ac(t,e):t instanceof Cc?kc(t,e):function(t,e){const n=bc(t,e),r=Nc(n)+Nc(t.Ae);return ua(n)&&ua(t.Ae)?wc(r):vc(t.serializer,r)}(t,e)}function Ic(t,e,n){return t instanceof Sc?Ac(t,e):t instanceof Cc?kc(t,e):n}function bc(t,e){return t instanceof Rc?function(t){return ua(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Tc extends _c{}class Sc extends _c{constructor(t){super(),this.elements=t}}function Ac(t,e){const n=Oc(e);for(const r of t.elements)n.some(t=>ra(t,r))||n.push(r);return{arrayValue:{values:n}}}class Cc extends _c{constructor(t){super(),this.elements=t}}function kc(t,e){let n=Oc(e);for(const r of t.elements)n=n.filter(t=>!ra(t,r));return{arrayValue:{values:n}}}class Rc extends _c{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Nc(t){return jo(t.integerValue||t.doubleValue)}function Oc(t){return ha(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Pc{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Pc}static exists(t){return new Pc(void 0,t)}static updateTime(t){return new Pc(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Dc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Lc{}function Mc(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Wc(t.key,Pc.none()):new Fc(t.key,t.data,Pc.none());{const n=t.data,r=ma.empty();let i=new Do(Ps.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new jc(t.key,r,new Mo(i.toArray()),Pc.none())}}function xc(t,e,n){t instanceof Fc?function(t,e,n){const r=t.value.clone(),i=Hc(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof jc?function(t,e,n){if(!Dc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=Hc(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Bc(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Vc(t,e,n,r){return t instanceof Fc?function(t,e,n,r){if(!Dc(t.precondition,e))return n;const i=t.value.clone(),s=qc(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof jc?function(t,e,n,r){if(!Dc(t.precondition,e))return n;const i=qc(t.fieldTransforms,r,e),s=e.data;return s.setAll(Bc(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,r):function(t,e,n){return Dc(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Uc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Cs(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Sc&&e instanceof Sc||t instanceof Cc&&e instanceof Cc?Cs(t.elements,e.elements,ra):t instanceof Rc&&e instanceof Rc?ra(t.Ae,e.Ae):t instanceof Tc&&e instanceof Tc}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fc extends Lc{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class jc extends Lc{constructor(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Bc(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Hc(t,e,n){const r=new Map;as(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Ic(o,a,n[i]))}return r}function qc(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,Ec(t,s,e))}return r}class Wc extends Lc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zc{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const e=this.mutations[r];e.key.isEqual(t.key)&&xc(e,t,n[r])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Vc(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Vc(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=dc();return this.mutations.forEach(r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=Mc(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Hs.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),gc())}isEqual(t){return this.batchId===t.batchId&&Cs(this.mutations,t.mutations,(t,e)=>Uc(t,e))&&Cs(this.baseMutations,t.baseMutations,(t,e)=>Uc(t,e))}}class Kc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}var Gc,Jc;function Xc(t){if(void 0===t)return ns("GRPC error has no .code"),ls.UNKNOWN;switch(t){case Gc.OK:return ls.OK;case Gc.CANCELLED:return ls.CANCELLED;case Gc.UNKNOWN:return ls.UNKNOWN;case Gc.DEADLINE_EXCEEDED:return ls.DEADLINE_EXCEEDED;case Gc.RESOURCE_EXHAUSTED:return ls.RESOURCE_EXHAUSTED;case Gc.INTERNAL:return ls.INTERNAL;case Gc.UNAVAILABLE:return ls.UNAVAILABLE;case Gc.UNAUTHENTICATED:return ls.UNAUTHENTICATED;case Gc.INVALID_ARGUMENT:return ls.INVALID_ARGUMENT;case Gc.NOT_FOUND:return ls.NOT_FOUND;case Gc.ALREADY_EXISTS:return ls.ALREADY_EXISTS;case Gc.PERMISSION_DENIED:return ls.PERMISSION_DENIED;case Gc.FAILED_PRECONDITION:return ls.FAILED_PRECONDITION;case Gc.ABORTED:return ls.ABORTED;case Gc.OUT_OF_RANGE:return ls.OUT_OF_RANGE;case Gc.UNIMPLEMENTED:return ls.UNIMPLEMENTED;case Gc.DATA_LOSS:return ls.DATA_LOSS;default:return ss(39323,{code:t})}}(Jc=Gc||(Gc={}))[Jc.OK=0]="OK",Jc[Jc.CANCELLED=1]="CANCELLED",Jc[Jc.UNKNOWN=2]="UNKNOWN",Jc[Jc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jc[Jc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jc[Jc.NOT_FOUND=5]="NOT_FOUND",Jc[Jc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jc[Jc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jc[Jc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jc[Jc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jc[Jc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jc[Jc.ABORTED=10]="ABORTED",Jc[Jc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jc[Jc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jc[Jc.INTERNAL=13]="INTERNAL",Jc[Jc.UNAVAILABLE=14]="UNAVAILABLE",Jc[Jc.DATA_LOSS=15]="DATA_LOSS";new Ui([4294967295,4294967295],0);Error;class Qc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Yc(t){return as(!!t,49232),Hs.fromTimestamp(function(t){const e=Fo(t);return new Bs(e.seconds,e.nanos)}(t))}function $c(t,e){const n=function(t){return new Ns(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Zc(t){const e=Ns.fromString(t);return as(sl(e),10190,{key:e.toString()}),e}function tl(t){const e=Zc(t);return 4===e.length?Ns.emptyPath():el(e)}function el(t){return as(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function nl(t){let e=tl(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){as(1===r,65062);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=rl(t);return e instanceof Sa&&Ca(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map(t=>function(t){return new Ea(il(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,eo(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new va(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new va(n,e)}(n.endAt)),za(e,i,o,s,a,"F",c,l)}function rl(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=il(t.unaryFilter.field);return Ta.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=il(t.unaryFilter.field);return Ta.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=il(t.unaryFilter.field);return Ta.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=il(t.unaryFilter.field);return Ta.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ss(61313);default:return ss(60726)}}(t):void 0!==t.fieldFilter?function(t){return Ta.create(il(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ss(58110);default:return ss(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Sa.create(t.compositeFilter.filters.map(t=>rl(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ss(1026)}}(t.compositeFilter.op))}(t):ss(30097,{filter:t})}function il(t){return Ps.fromServerFormat(t.fieldPath)}function sl(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class ol{constructor(t){this.yt=t}}function al(t){const e=nl({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?$a(e,e.limit,"L"):e}class cl{constructor(){}Dt(t,e){this.Ct(t,e),e.vt()}Ct(t,e){if("nullValue"in t)this.Ft(e,5);else if("booleanValue"in t)this.Ft(e,10),e.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(e,15),e.Mt(jo(t.integerValue));else if("doubleValue"in t){const n=jo(t.doubleValue);isNaN(n)?this.Ft(e,13):(this.Ft(e,15),no(n)?e.Mt(0):e.Mt(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Ft(e,20),"string"==typeof n&&(n=Fo(n)),e.xt("".concat(n.seconds||"")),e.Mt(n.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,e),this.Nt(e);else if("bytesValue"in t)this.Ft(e,30),e.Bt(Bo(t.bytesValue)),this.Nt(e);else if("referenceValue"in t)this.Lt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Ft(e,45),e.Mt(n.latitude||0),e.Mt(n.longitude||0)}else"mapValue"in t?ga(t)?this.Ft(e,Number.MAX_SAFE_INTEGER):fa(t)?this.kt(t.mapValue,e):(this.Kt(t.mapValue,e),this.Nt(e)):"arrayValue"in t?(this.qt(t.arrayValue,e),this.Nt(e)):ss(19022,{Ut:t})}Ot(t,e){this.Ft(e,25),this.$t(t,e)}$t(t,e){e.xt(t)}Kt(t,e){const n=t.fields||{};this.Ft(e,55);for(const r of Object.keys(n))this.Ot(r,e),this.Ct(n[r],e)}kt(t,e){var n;const r=t.fields||{};this.Ft(e,53);const i=ea,s=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(e,15),e.Mt(jo(s)),this.Ot(i,e),this.Ct(r[i],e)}qt(t,e){const n=t.values||[];this.Ft(e,50);for(const r of n)this.Ct(r,e)}Lt(t,e){this.Ft(e,37),Ds.fromName(t).path.forEach(t=>{this.Ft(e,60),this.$t(t,e)})}Ft(t,e){t.Mt(e)}Nt(t){t.Mt(2)}}cl.Wt=new cl;class ll{constructor(){this.Sn=new ul}addToCollectionParentIndex(t,e){return this.Sn.add(e),Qs.resolve()}getCollectionParents(t,e){return Qs.resolve(this.Sn.getEntries(e))}addFieldIndex(t,e){return Qs.resolve()}deleteFieldIndex(t,e){return Qs.resolve()}deleteAllFieldIndexes(t){return Qs.resolve()}createTargetIndexes(t,e){return Qs.resolve()}getDocumentsMatchingTarget(t,e){return Qs.resolve(null)}getIndexType(t,e){return Qs.resolve(0)}getFieldIndexes(t,e){return Qs.resolve([])}getNextCollectionGroupToUpdate(t){return Qs.resolve(null)}getMinOffset(t,e){return Qs.resolve(Gs.min())}getMinOffsetFromCollectionGroup(t,e){return Qs.resolve(Gs.min())}updateCollectionGroup(t,e,n){return Qs.resolve()}updateIndexEntries(t,e){return Qs.resolve()}}class ul{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Do(Ns.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new Do(Ns.comparator)).toArray()}}new Uint8Array(0);const hl=41943040;class dl{static withCacheSize(t){return new dl(t,dl.DEFAULT_COLLECTION_PERCENTILE,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}dl.DEFAULT_COLLECTION_PERCENTILE=10,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dl.DEFAULT=new dl(hl,dl.DEFAULT_COLLECTION_PERCENTILE,dl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dl.DISABLED=new dl(-1,0,0);class fl{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new fl(0)}static ar(){return new fl(-1)}}const pl=1048576;class gl{constructor(){this.changes=new sc(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,ya.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Qs.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class ml{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class yl{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(n=r,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&Vc(n.mutation,t,Mo.empty(),Bs.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,gc()).next(()=>e))}getLocalViewOfDocuments(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gc();const r=hc();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,n).next(t=>{let e=lc();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=hc();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,gc()))}populateOverlays(t,e,n){const r=[];return n.forEach(t=>{e.has(t)||r.push(t)}),this.documentOverlayCache.getOverlays(t,r).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,r){let i=ac();const s=fc(),o=fc();return e.forEach((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof jc)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),Vc(o.mutation,e,o.mutation.getFieldMask(),Bs.now())):s.set(e.key,Mo.empty())}),this.recalculateAndSaveOverlays(t,i).next(t=>(t.forEach((t,e)=>s.set(t,e)),e.forEach((t,e)=>{var n;return o.set(t,new ml(e,null!==(n=s.get(t))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(t,e){const n=fc();let r=new No((t,e)=>t-e),i=gc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const i of t)i.keys().forEach(t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Mo.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||gc()).add(t);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=dc();c.forEach(t=>{if(!i.has(t)){const r=Mc(e.get(t),n.get(t));null!==r&&l.set(t,r),i=i.add(t)}}),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Qs.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return Ds.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Ja(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):Qs.resolve(hc());let o=qs,a=i;return s.next(e=>Qs.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?Qs.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,i)).next(()=>this.computeViews(t,a,e,gc())).next(t=>({batchId:o,changes:uc(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ds(e)).next(t=>{let e=lc();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=lc();return this.indexManager.getCollectionParents(t,i).next(o=>Qs.forEach(o,o=>{const a=function(t,e){return new Wa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next(t=>{t.forEach((t,e)=>{s=s.insert(t,e)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r))).next(t=>{i.forEach((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,ya.newInvalidDocument(r)))});let n=lc();return t.forEach((t,r)=>{const s=i.get(t);void 0!==s&&Vc(s.mutation,r,Mo.empty(),Bs.now()),nc(e,r)&&(n=n.insert(t,r))}),n})}}class vl{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,e){return Qs.resolve(this.Nr.get(e))}saveBundleMetadata(t,e){return this.Nr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Yc(t.createTime)}}(e)),Qs.resolve()}getNamedQuery(t,e){return Qs.resolve(this.Br.get(e))}saveNamedQuery(t,e){return this.Br.set(e.name,function(t){return{name:t.name,query:al(t.bundledQuery),readTime:Yc(t.readTime)}}(e)),Qs.resolve()}}class wl{constructor(){this.overlays=new No(Ds.comparator),this.Lr=new Map}getOverlay(t,e){return Qs.resolve(this.overlays.get(e))}getOverlays(t,e){const n=hc();return Qs.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,r)=>{this.bt(t,e,r)}),Qs.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.Lr.get(n);return void 0!==r&&(r.forEach(t=>this.overlays=this.overlays.remove(t)),this.Lr.delete(n)),Qs.resolve()}getOverlaysForCollection(t,e,n){const r=hc(),i=e.length+1,s=new Ds(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return Qs.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new No((t,e)=>t-e);const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=hc(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=hc(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=r)););return Qs.resolve(o)}bt(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.Lr.get(r.largestBatchId).delete(n.key);this.Lr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Kc(e,n));let i=this.Lr.get(e);void 0===i&&(i=gc(),this.Lr.set(e,i)),this.Lr.set(e,i.add(n.key))}}class _l{constructor(){this.sessionToken=Vo.EMPTY_BYTE_STRING}getSessionToken(t){return Qs.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,Qs.resolve()}}class El{constructor(){this.kr=new Do(Il.Kr),this.qr=new Do(Il.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,e){const n=new Il(t,e);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.Wr(new Il(t,e))}Qr(t,e){t.forEach(t=>this.removeReference(t,e))}Gr(t){const e=new Ds(new Ns([])),n=new Il(e,t),r=new Il(e,t+1),i=[];return this.qr.forEachInRange([n,r],t=>{this.Wr(t),i.push(t.key)}),i}zr(){this.kr.forEach(t=>this.Wr(t))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const e=new Ds(new Ns([])),n=new Il(e,t),r=new Il(e,t+1);let i=gc();return this.qr.forEachInRange([n,r],t=>{i=i.add(t.key)}),i}containsKey(t){const e=new Il(t,0),n=this.kr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Il{constructor(t,e){this.key=t,this.Hr=e}static Kr(t,e){return Ds.comparator(t.key,e.key)||Is(t.Hr,e.Hr)}static Ur(t,e){return Is(t.Hr,e.Hr)||Ds.comparator(t.key,e.key)}}class bl{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Yn=1,this.Jr=new Do(Il.Kr)}checkEmpty(t){return Qs.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new zc(i,e,n,r);this.mutationQueue.push(s);for(const o of r)this.Jr=this.Jr.add(new Il(o.key,i)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return Qs.resolve(s)}lookupMutationBatch(t,e){return Qs.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.Xr(n),i=r<0?0:r;return Qs.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Qs.resolve(0===this.mutationQueue.length?to:this.Yn-1)}getAllMutationBatches(t){return Qs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Il(e,0),r=new Il(e,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([n,r],t=>{const e=this.Zr(t.Hr);i.push(e)}),Qs.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Do(Is);return e.forEach(t=>{const e=new Il(t,0),r=new Il(t,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([e,r],t=>{n=n.add(t.Hr)})}),Qs.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;Ds.isDocumentKey(i)||(i=i.child(""));const s=new Il(new Ds(i),0);let o=new Do(Is);return this.Jr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.Hr)),!0)},s),Qs.resolve(this.Yr(o))}Yr(t){const e=[];return t.forEach(t=>{const n=this.Zr(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){as(0===this.ei(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Jr;return Qs.forEach(e.mutations,r=>{const i=new Il(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Jr=n})}nr(t){}containsKey(t,e){const n=new Il(e,0),r=this.Jr.firstAfterOrEqual(n);return Qs.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,Qs.resolve()}ei(t,e){return this.Xr(t)}Xr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Tl{constructor(t){this.ti=t,this.docs=new No(Ds.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.ti(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Qs.resolve(n?n.document.mutableCopy():ya.newInvalidDocument(e))}getEntries(t,e){let n=ac();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():ya.newInvalidDocument(t))}),Qs.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=ac();const s=e.path,o=new Ds(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||Js(Ks(o),n)<=0||(r.has(o.key)||nc(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Qs.resolve(i)}getAllFromCollectionGroup(t,e,n,r){ss(9500)}ni(t,e){return Qs.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new Sl(this)}getSize(t){return Qs.resolve(this.size)}}class Sl extends gl{constructor(t){super(),this.Mr=t}applyChanges(t){const e=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?e.push(this.Mr.addEntry(t,r)):this.Mr.removeEntry(n)}),Qs.waitFor(e)}getFromCache(t,e){return this.Mr.getEntry(t,e)}getAllFromCache(t,e){return this.Mr.getEntries(t,e)}}class Al{constructor(t){this.persistence=t,this.ri=new sc(t=>Ha(t),qa),this.lastRemoteSnapshotVersion=Hs.min(),this.highestTargetId=0,this.ii=0,this.si=new El,this.targetCount=0,this.oi=fl._r()}forEachTarget(t,e){return this.ri.forEach((t,n)=>e(n)),Qs.resolve()}getLastRemoteSnapshotVersion(t){return Qs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Qs.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),Qs.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ii&&(this.ii=e),Qs.resolve()}lr(t){this.ri.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.oi=new fl(e),this.highestTargetId=e),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,e){return this.lr(e),this.targetCount+=1,Qs.resolve()}updateTargetData(t,e){return this.lr(e),Qs.resolve()}removeTargetData(t,e){return this.ri.delete(e.target),this.si.Gr(e.targetId),this.targetCount-=1,Qs.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.ri.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.ri.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)}),Qs.waitFor(i).next(()=>r)}getTargetCount(t){return Qs.resolve(this.targetCount)}getTargetData(t,e){const n=this.ri.get(e)||null;return Qs.resolve(n)}addMatchingKeys(t,e,n){return this.si.$r(e,n),Qs.resolve()}removeMatchingKeys(t,e,n){this.si.Qr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(e=>{i.push(r.markPotentiallyOrphaned(t,e))}),Qs.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.si.Gr(e),Qs.resolve()}getMatchingKeysForTargetId(t,e){const n=this.si.jr(e);return Qs.resolve(n)}containsKey(t,e){return Qs.resolve(this.si.containsKey(e))}}class Cl{constructor(t,e){this._i={},this.overlays={},this.ai=new Zs(0),this.ui=!1,this.ui=!0,this.ci=new _l,this.referenceDelegate=t(this),this.li=new Al(this),this.indexManager=new ll,this.remoteDocumentCache=function(t){return new Tl(t)}(t=>this.referenceDelegate.hi(t)),this.serializer=new ol(e),this.Pi=new vl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new wl,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this._i[t.toKey()];return n||(n=new bl(e,this.referenceDelegate),this._i[t.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,e,n){es("MemoryPersistence","Starting transaction:",t);const r=new kl(this.ai.next());return this.referenceDelegate.Ti(),n(r).next(t=>this.referenceDelegate.Ii(r).next(()=>t)).toPromise().then(t=>(r.raiseOnCommittedEvent(),t))}Ei(t,e){return Qs.or(Object.values(this._i).map(n=>()=>n.containsKey(t,e)))}}class kl extends Xs{constructor(t){super(),this.currentSequenceNumber=t}}class Rl{constructor(t){this.persistence=t,this.Ri=new El,this.Ai=null}static Vi(t){return new Rl(t)}get di(){if(this.Ai)return this.Ai;throw ss(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.di.delete(n.toString()),Qs.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.di.add(n.toString()),Qs.resolve()}markPotentiallyOrphaned(t,e){return this.di.add(e.toString()),Qs.resolve()}removeTarget(t,e){this.Ri.Gr(e.targetId).forEach(t=>this.di.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.di.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}Ti(){this.Ai=new Set}Ii(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qs.forEach(this.di,n=>{const r=Ds.fromPath(n);return this.mi(t,r).next(t=>{t||e.removeEntry(r,Hs.min())})}).next(()=>(this.Ai=null,e.apply(t)))}updateLimboDocument(t,e){return this.mi(t,e).next(t=>{t?this.di.delete(e.toString()):this.di.add(e.toString())})}hi(t){return 0}mi(t,e){return Qs.or([()=>Qs.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class Nl{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ts=n,this.Is=r}static Es(t,e){let n=gc(),r=gc();for(const i of e.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Nl(t,e.fromCache,n,r)}}class Ol{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Pl{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=A()?8:Ys(T())>0?6:4}initialize(t,e){this.fs=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.gs(t,e).next(t=>{i.result=t}).next(()=>{if(!i.result)return this.ps(t,e,r,n).next(t=>{i.result=t})}).next(()=>{if(i.result)return;const n=new Ol;return this.ys(t,e,n).next(r=>{if(i.result=r,this.As)return this.ws(t,e,n,r.size)})}).next(()=>i.result)}ws(t,e,n,r){return n.documentReadCount<this.Vs?(ts()<=W.DEBUG&&es("QueryEngine","SDK will not create cache indexes for query:",ec(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Qs.resolve()):(ts()<=W.DEBUG&&es("QueryEngine","Query:",ec(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ds*r?(ts()<=W.DEBUG&&es("QueryEngine","The SDK decides to create cache indexes for query:",ec(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Qa(e))):Qs.resolve())}gs(t,e){if(Ga(e))return Qs.resolve(null);let n=Qa(e);return this.indexManager.getIndexType(t,n).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=$a(e,null,"F"),n=Qa(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(r=>{const i=gc(...r);return this.fs.getDocuments(t,i).next(r=>this.indexManager.getMinOffset(t,n).next(n=>{const s=this.bs(e,r);return this.Ss(e,s,i,n.readTime)?this.gs(t,$a(e,null,"F")):this.Ds(t,s,e,n)}))})))}ps(t,e,n,r){return Ga(e)||r.isEqual(Hs.min())?Qs.resolve(null):this.fs.getDocuments(t,n).next(i=>{const s=this.bs(e,i);return this.Ss(e,s,n,r)?Qs.resolve(null):(ts()<=W.DEBUG&&es("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ec(e)),this.Ds(t,s,e,zs(r,qs)).next(t=>t))})}bs(t,e){let n=new Do(rc(t));return e.forEach((e,r)=>{nc(t,r)&&(n=n.add(r))}),n}Ss(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ys(t,e,n){return ts()<=W.DEBUG&&es("QueryEngine","Using full collection scan to execute query:",ec(e)),this.fs.getDocumentsMatchingQuery(t,e,Gs.min(),n)}Ds(t,e,n,r){return this.fs.getDocumentsMatchingQuery(t,n,r).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}const Dl="LocalStore";class Ll{constructor(t,e,n,r){this.persistence=t,this.Cs=e,this.serializer=r,this.vs=new No(Is),this.Fs=new sc(t=>Ha(t),qa),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(n)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new yl(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.vs))}}function Ml(t,e,n,r){return new Ll(t,e,n,r)}async function xl(t,e){const n=cs(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next(i=>(r=i,n.Os(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const i=[],s=[];let o=gc();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({Ns:t,removedBatchIds:i,addedBatchIds:s}))})})}class Vl{constructor(){this.activeTargetIds=yc()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ul{constructor(){this.vo=new Vl,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,e,n){this.Fo[t]=e}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new Vl,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Fl{Mo(t){}shutdown(){}}const jl="ConnectivityMonitor";class Bl{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){es(jl,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){es(jl,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Hl=null;function ql(){return null===Hl?Hl=268435456+Math.round(2147483648*Math.random()):Hl++,"0x"+Hl.toString(16)}const Wl="RestConnection",zl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Kl{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo="projects/".concat(n,"/databases/").concat(r),this.$o=this.databaseId.database===Xo?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Wo(t,e,n,r,i){const s=ql(),o=this.Qo(t,e.toUriEncodedString());es(Wl,"Sending RPC '".concat(t,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(a,r,i);const{host:c}=new URL(o),l=w(c);return this.zo(t,o,a,n,l).then(e=>(es(Wl,"Received RPC '".concat(t,"' ").concat(s,": "),e),e),e=>{throw rs(Wl,"RPC '".concat(t,"' ").concat(s," failed with error: "),e,"url: ",o,"request:",n),e})}jo(t,e,n,r,i,s){return this.Wo(t,e,n,r,i)}Go(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+$i,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}Qo(t,e){const n=zl[t];let r="".concat(this.qo,"/v1/").concat(e,":").concat(n);return this.databaseInfo.apiKey&&(r="".concat(r,"?key=").concat(encodeURIComponent(this.databaseInfo.apiKey))),r}terminate(){}}class Gl{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const Jl="WebChannelConnection",Xl=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};class Ql extends Kl{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!Ql.c_){const t=Gi();Xl(t,Ki.STAT_EVENT,t=>{t.stat===zi.PROXY?es(Jl,"STAT_EVENT: detected buffering proxy"):t.stat===zi.NOPROXY&&es(Jl,"STAT_EVENT: detected no buffering proxy")}),Ql.c_=!0}}zo(t,e,n,r,i){const s=ql();return new Promise((i,o)=>{const a=new Bi;a.setWithCredentials(!0),a.listenOnce(qi.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Wi.NO_ERROR:const n=a.getResponseJson();es(Jl,"XHR for RPC '".concat(t,"' ").concat(s," received:"),JSON.stringify(n)),i(n);break;case Wi.TIMEOUT:es(Jl,"RPC '".concat(t,"' ").concat(s," timed out")),o(new us(ls.DEADLINE_EXCEEDED,"Request time out"));break;case Wi.HTTP_ERROR:const r=a.getStatus();if(es(Jl,"RPC '".concat(t,"' ").concat(s," failed with status:"),r,"response text:",a.getResponseText()),r>0){var e;let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const n=null===(e=t)||void 0===e?void 0:e.error;if(n&&n.status&&n.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ls).indexOf(e)>=0?e:ls.UNKNOWN}(n.status);o(new us(t,n.message))}else o(new us(ls.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new us(ls.UNAVAILABLE,"Connection failed."));break;default:ss(9055,{l_:t,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{es(Jl,"RPC '".concat(t,"' ").concat(s," completed."))}});const c=JSON.stringify(r);es(Jl,"RPC '".concat(t,"' ").concat(s," sending request:"),r),a.send(e,"POST",c,n,15)})}T_(t,e,n){const r=ql(),i=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=this.createWebChannelTransport(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},a=this.longPollingOptions.timeoutSeconds;void 0!==a&&(o.longPollingTimeout=Math.round(1e3*a)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Go(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const c=i.join("");es(Jl,"Creating RPC '".concat(t,"' stream ").concat(r,": ").concat(c),o);const l=s.createWebChannel(c,o);this.I_(l);let u=!1,h=!1;const d=new Gl({Ho:e=>{h?es(Jl,"Not sending because RPC '".concat(t,"' stream ").concat(r," is closed:"),e):(u||(es(Jl,"Opening RPC '".concat(t,"' stream ").concat(r," transport.")),l.open(),u=!0),es(Jl,"RPC '".concat(t,"' stream ").concat(r," sending:"),e),l.send(e))},Jo:()=>l.close()});return Xl(l,Hi.EventType.OPEN,()=>{h||(es(Jl,"RPC '".concat(t,"' stream ").concat(r," transport opened.")),d.i_())}),Xl(l,Hi.EventType.CLOSE,()=>{h||(h=!0,es(Jl,"RPC '".concat(t,"' stream ").concat(r," transport closed")),d.o_(),this.E_(l))}),Xl(l,Hi.EventType.ERROR,e=>{h||(h=!0,rs(Jl,"RPC '".concat(t,"' stream ").concat(r," transport errored. Name:"),e.name,"Message:",e.message),d.o_(new us(ls.UNAVAILABLE,"The operation could not be completed")))}),Xl(l,Hi.EventType.MESSAGE,e=>{if(!h){var n;const i=e.data[0];as(!!i,16349);const s=i,o=(null===s||void 0===s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){es(Jl,"RPC '".concat(t,"' stream ").concat(r," received error:"),o);const e=o.status;let n=function(t){const e=Gc[t];if(void 0!==e)return Xc(e)}(e),i=o.message;"NOT_FOUND"===e&&i.includes("database")&&i.includes("does not exist")&&i.includes(this.databaseId.database)&&rs("Database '".concat(this.databaseId.database,"' not found. Please check your project configuration.")),void 0===n&&(n=ls.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),h=!0,d.o_(new us(n,i)),l.close()}else es(Jl,"RPC '".concat(t,"' stream ").concat(r," received:"),i),d.__(i)}}),Ql.u_(),setTimeout(()=>{d.s_()},0),d}terminate(){this.a_.forEach(t=>t.close()),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter(e=>e===t)}Go(t,e,n){super.Go(t,e,n),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Ji()}}function Yl(t){return new Ql(t)}function $l(){return"undefined"!=typeof document?document:null}function Zl(t){return new Qc(t,!0)}Ql.c_=!1;class tu{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ci=t,this.timerId=e,this.R_=n,this.A_=r,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const e=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,e-n);r>0&&es("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.d_," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),t())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}class eu{}class nu extends eu{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new us(ls.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Wo(t,$c(e,n),r,s,o)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===ls.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new us(ls.UNKNOWN,t.toString())})}jo(t,e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.jo(t,$c(e,n),r,o,a,i)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===ls.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new us(ls.UNKNOWN,t.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function ru(t,e,n,r){return new nu(t,e,n,r)}class iu{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,"Online"===t&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(ns(e),this.aa=!1):es("OnlineStateTracker",e)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const su="RemoteStore";class ou{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(t=>{n.enqueueAndForget(async()=>{lu(this)&&(es(su,"Restarting streams for network reachability change."),await async function(t){const e=cs(t);e.Ea.add(4),await cu(e),e.Va.set("Unknown"),e.Ea.delete(4),await au(e)}(this))})}),this.Va=new iu(n,r)}}async function au(t){if(lu(t))for(const e of t.Ra)await e(!0)}async function cu(t){for(const e of t.Ra)await e(!1)}function lu(t){return 0===cs(t).Ea.size}async function uu(t,e){const n=cs(t);e?(n.Ea.delete(2),await au(n)):e||(n.Ea.add(2),await cu(n),n.Va.set("Unknown"))}class hu{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new hu(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new us(ls.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class du{constructor(){this.queries=fu(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,e){const n=cs(t),r=n.queries;n.queries=fu(),r.forEach((t,n)=>{for(const r of n.ba)r.onError(e)})}(this,new us(ls.ABORTED,"Firestore shutting down"))}}function fu(){return new sc(t=>tc(t),Za)}function pu(t){t.Ca.forEach(t=>{t.next()})}var gu,mu;(mu=gu||(gu={})).Ma="default",mu.Cache="cache";const yu="SyncEngine";class vu{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new sc(t=>tc(t),Za),this.Iu=new Map,this.Eu=new Set,this.Ru=new No(Ds.comparator),this.Au=new Map,this.Vu=new El,this.du={},this.mu=new Map,this.fu=fl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function wu(t,e,n){const r=cs(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.Tu.forEach((n,r)=>{const i=r.view.va(e);i.snapshot&&t.push(i.snapshot)}),function(t,e){const n=cs(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const i of n.ba)i.va(e)&&(r=!0)}),r&&pu(n)}(r.eventManager,e),t.length&&r.Pu.J_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _u(t,e,n){const r=cs(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((t,a)=>{o.push(r.pu(a,e,n).then(t=>{if((t||n)&&r.isPrimaryClient){var e;const i=t?!t.fromCache:null===n||void 0===n||null===(e=n.targetChanges.get(a.targetId))||void 0===e?void 0:e.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(t){i.push(t);const e=Nl.Es(a.targetId,t);s.push(e)}}))}),await Promise.all(o),r.Pu.J_(i),await async function(t,e){const n=cs(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>Qs.forEach(e,e=>Qs.forEach(e.Ts,r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r)).next(()=>Qs.forEach(e.Is,r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))}catch(t){if(!$s(t))throw t;es(Dl,"Failed to update sequence numbers: "+t)}for(const r of e){const t=r.targetId;if(!r.fromCache){const e=n.vs.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.vs=n.vs.insert(t,i)}}}(r.localStore,s))}async function Eu(t,e){const n=cs(t);if(!n.currentUser.isEqual(e)){es(yu,"User change. New user:",e.toKey());const t=await xl(n.localStore,e);n.currentUser=e,function(t,e){t.mu.forEach(t=>{t.forEach(t=>{t.reject(new us(ls.CANCELLED,e))})}),t.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await _u(n,t.Ns)}}class Iu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Zl(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return Ml(this.persistence,new Pl,t.initialUser,this.serializer)}Cu(t){return new Cl(Rl.Vi,this.serializer)}Du(t){return new Ul}async terminate(){var t,e;null!==(t=this.gcScheduler)&&void 0!==t&&t.stop(),null!==(e=this.indexBackfillerScheduler)&&void 0!==e&&e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Iu.provider={build:()=>new Iu};class bu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>wu(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Eu.bind(null,this.syncEngine),await uu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new du}createDatastore(t){const e=Zl(t.databaseInfo.databaseId),n=Yl(t.databaseInfo);return ru(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new ou(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,t=>wu(this.syncEngine,t,0),Bl.v()?new Bl:new Fl)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new vu(t,e,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=cs(t);es(su,"RemoteStore shutting down."),e.Ea.add(5),await cu(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),null!==(t=this.datastore)&&void 0!==t&&t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}bu.provider={build:()=>new bu};function Tu(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Su="ComponentProvider",Au=new Map;const Cu="firestore.googleapis.com",ku=!0;class Ru{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new us(ls.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cu,this.ssl=ku}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:ku;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=hl;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<pl)throw new us(ls.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new us(ls.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Tu(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new us(ls.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new us(ls.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new us(ls.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Nu{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ru({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new us(ls.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new us(ls.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ru(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new fs;switch(t.type){case"firstParty":return new ys(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new us(ls.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Au.get(t);e&&(es(Su,"Removing Datastore"),Au.delete(t),e.terminate())}(this),Promise.resolve()}}function Ou(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t=xs(t,Nu);const i=w(e),s=t._getSettings(),o=a(a({},s),{},{emulatorOptions:t._getEmulatorOptions()}),c="".concat(e,":").concat(n);i&&(_("https://".concat(c)),b("Firestore",!0)),s.host!==Cu&&s.host!==c&&rs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=a(a({},s),{},{host:c,ssl:i,emulatorOptions:r});if(!O(l,o)&&(t._setSettings(l),r.mockUserToken)){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=Yi.MOCK_USER;else{var u;e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=a({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(u=t._app)||void 0===u?void 0:u.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new us(ls.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Yi(i)}t._authCredentials=new ps(new ds(e,n))}}class Pu{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Pu(this.firestore,t,this._query)}}class Du{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Du(this.firestore,t,this._key)}toJSON(){return{type:Du._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(Us(e,Du._jsonSchema))return new Du(t,n||null,new Ds(Ns.fromString(e.referencePath)))}}Du._jsonSchemaVersion="firestore/documentReference/1.0",Du._jsonSchema={type:Vs("string",Du._jsonSchemaVersion),referencePath:Vs("string")};class Lu extends Pu{constructor(t,e,n){super(t,e,Ka(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Du(this.firestore,null,new Ds(t))}withConverter(t){return new Lu(this.firestore,t,this._path)}}const Mu="AsyncQueue";class xu{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tu(this,"async_queue_retry"),this._c=()=>{const t=$l();t&&es(Mu,"Visibility state changed to "+t.visibilityState),this.M_.w_()},this.ac=t;const e=$l();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=$l();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const e=new hs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Yu.push(t),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!$s(t))throw t;es(Mu,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const e=this.ac.then(()=>(this.rc=!0,t().catch(t=>{throw this.nc=t,this.rc=!1,ns("INTERNAL UNHANDLED ERROR: ",Vu(t)),t}).then(t=>(this.rc=!1,t))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const r=hu.createAndSchedule(this,t,e,n,t=>this.hc(t));return this.tc.push(r),r}uc(){this.nc&&ss(47125,{Pc:Vu(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do{t=this.ac,await t}while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.tc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Tc()})}Rc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function Vu(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}class Uu extends Nu{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new xu,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new xu(t),this._firestoreClient=void 0,await t}}}class Fu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Fu(Vo.fromBase64String(t))}catch(t){throw new us(ls.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Fu(Vo.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Fu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Us(t,Fu._jsonSchema))return Fu.fromBase64String(t.bytes)}}Fu._jsonSchemaVersion="firestore/bytes/1.0",Fu._jsonSchema={type:Vs("string",Fu._jsonSchemaVersion),bytes:Vs("string")};class ju{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(let r=0;r<e.length;++r)if(0===e[r].length)throw new us(ls.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ps(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Bu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new us(ls.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new us(ls.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Is(this._lat,t._lat)||Is(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bu._jsonSchemaVersion}}static fromJSON(t){if(Us(t,Bu._jsonSchema))return new Bu(t.latitude,t.longitude)}}Bu._jsonSchemaVersion="firestore/geoPoint/1.0",Bu._jsonSchema={type:Vs("string",Bu._jsonSchemaVersion),latitude:Vs("number"),longitude:Vs("number")};class Hu{constructor(t){this._values=(t||[]).map(t=>t)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Hu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Us(t,Hu._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(t=>"number"==typeof t))return new Hu(t.vectorValues);throw new us(ls.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Hu._jsonSchemaVersion="firestore/vectorValue/1.0",Hu._jsonSchema={type:Vs("string",Hu._jsonSchemaVersion),vectorValues:Vs("object")};function qu(t,e,n){if((e=U(e))instanceof ju)return e._internalPath;if("string"==typeof e)return zu(t,e);throw Ku("Field path arguments must be of type string or ",t,!1,void 0,n)}const Wu=new RegExp("[~\\*/\\[\\]]");function zu(t,e,n){if(e.search(Wu)>=0)throw Ku("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return new ju(...e.split("."))._internalPath}catch(r){throw Ku("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function Ku(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(e,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=" in field ".concat(r)),o&&(c+=" in document ".concat(i)),c+=")"),new us(ls.INVALID_ARGUMENT,a+t+c)}const Gu="@firebase/firestore",Ju="4.11.0";class Xu{constructor(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Du(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Qu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var t,e;return null!==(t=null===(e=this._document)||void 0===e?void 0:e.data.clone().value.mapValue.fields)&&void 0!==t?t:void 0}get(t){if(this._document){const e=this._document.data.field(qu("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Qu extends Xu{data(){return super.data()}}class Yu{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class $u extends Xu{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new Zu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(qu("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new us(ls.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=$u._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),t&&t.isValidDocument()&&t.isFoundDocument()?(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e):e}}$u._jsonSchemaVersion="firestore/documentSnapshot/1.0",$u._jsonSchema={type:Vs("string",$u._jsonSchemaVersion),bundleSource:Vs("string","DocumentSnapshot"),bundleName:Vs("string"),bundle:Vs("string")};class Zu extends $u{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class th{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Yu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new Zu(this._firestore,this._userDataWriter,n.key,n,new Yu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new us(ls.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>{const r=new Zu(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Yu(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:e++}})}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new Zu(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Yu(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:eh(e.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new us(ls.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=th._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Es.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],r=[];return this.docs.forEach(t=>{null!==t._document&&(e.push(t._document),n.push(this._userDataWriter.convertObjectMap(t._document.data.value.mapValue.fields,"previous")),r.push(t.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function eh(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ss(61501,{type:t})}}th._jsonSchemaVersion="firestore/querySnapshot/1.0",th._jsonSchema={type:Vs("string",th._jsonSchemaVersion),bundleSource:Vs("string","QuerySnapshot"),bundleName:Vs("string"),bundle:Vs("string")};new WeakMap;!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$i=Zt,Jt(new F("firestore",(t,n)=>{let{instanceIdentifier:r,options:i}=n;const s=t.getProvider("app").getImmediate(),o=new Uu(new gs(t.getProvider("auth-internal")),new ws(s,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new us(ls.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(t.options.projectId,e)}(s,r),s);return i=a({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),ne(Gu,Ju,t),ne(Gu,Ju,"esm2020")}();n(579);const nh=te(JSON.parse(__firebase_config));(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee();const e=Xt(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=Xt(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(O(n.getOptions(),null!==e&&void 0!==e?e:{}))return t;Ie(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Oi,persistence:[Br,Er,Ar]}),r=y("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const t=new URL(r,location.origin);if(location.origin===t.origin){const e=(i=t.toString(),async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Mi)return;const r=null===e||void 0===e?void 0:e.token;xi!==r&&(xi=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(t,e,n){U(t).beforeAuthStateChanged(e,n)}(n,e,()=>e(n.currentUser)),function(t,e,n,r){U(t).onIdTokenChanged(e,n,r)}(n,t=>e(t))}}var i;const s=g("auth");s&&Wn(n,"http://".concat(s))})(nh),function(t,e){const n="object"==typeof t?t:ee(),r="string"==typeof t?t:e||Xo,i=Xt(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const t=(t=>{const e=g(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("firestore");t&&Ou(i,...t)}}(nh),"undefined"!==typeof __app_id&&__app_id})();
//# sourceMappingURL=main.50f4c93f.js.map